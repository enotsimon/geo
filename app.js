!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},n={},r={},a={}.hasOwnProperty,i=/^\.\.?(\/|$)/,o=function(e,t){for(var n,r=[],a=(i.test(t)?e+"/"+t:t).split("/"),o=0,l=a.length;o<l;o++)n=a[o],".."===n?r.pop():"."!==n&&""!==n&&r.push(n);return r.join("/")},l=function(e){return e.split("/").slice(0,-1).join("/")},u=function(t){return function(n){var r=o(l(t),n);return e.require(r,t)}},s=function(e,t){var r=m&&m.createHot(e),a={id:e,exports:{},hot:r};return n[e]=a,t(a.exports,u(e),a),a.exports},c=function(e){return r[e]?c(r[e]):e},f=function(e,t){return c(o(l(e),t))},d=function(e,r){null==r&&(r="/");var i=c(e);if(a.call(n,i))return n[i].exports;if(a.call(t,i))return s(i,t[i]);throw new Error("Cannot find module '"+e+"' from '"+r+"'")};d.alias=function(e,t){r[t]=e};var h=/\.[^.\/]+$/,_=/\/index(\.[^\/]+)?$/,p=function(e){if(h.test(e)){var t=e.replace(h,"");a.call(r,t)&&r[t].replace(h,"")!==t+"/index"||(r[t]=e)}if(_.test(e)){var n=e.replace(_,"");a.call(r,n)||(r[n]=e)}};d.register=d.define=function(e,r){if(e&&"object"==typeof e)for(var i in e)a.call(e,i)&&d.register(i,e[i]);else t[e]=r,delete n[e],p(e)},d.list=function(){var e=[];for(var n in t)a.call(t,n)&&e.push(n);return e};var m=e._hmr&&new e._hmr(f,d,t,n);d._cache=n,d.hmr=m&&m.wrap,d.brunch=!0,e.require=d}}(),function(){"undefined"==typeof window?this:window;require.register("child_process",function(e,t,n){n.exports={}}),require.register("fs",function(e,t,n){n.exports={}});var e;require.register("chaos/actions.js",function(e,t,n){"use strict";function r(){return{type:o}}function a(){return{type:l}}function i(){return{type:u}}Object.defineProperty(e,"__esModule",{value:!0}),e.tick=r,e.advance_symbols_complete=a,e.exchange_symbols_complete=i;var o=e.TICK="tick",l=e.ADVANCE_SYMBOLS_COMPLETE="advance_symbols_complete",u=e.EXCHANGE_SYMBOLS_COMPLETE="exchange_symbols_complete"}),require.register("chaos/agent.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=function(){function e(t,n){a(this,e),this.x=t,this.y=n,this.stat={}}return i(e,[{key:"add_symbol_class",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(this[e]=[],this.stat[e]={counters:{},valuables:[],exchange_flag:!1},t.forEach(function(t){return n.push_symbol(e,t)}),this.calc_valuables(e);r-- >0;)this.advance_array(this[e])}},{key:"advance_symbol_classes",value:function(){var e=this;this.for_all_symbol_classes(function(t,n){return e.advance_array(t)})}},{key:"are_you_gonna_exchange",value:function(e){return!this.get_exchange_flag(e)&&!this.is_valuable_symbol(this.get_current_symbol(e),e)}},{key:"is_valuable_symbol",value:function(e,t){return this.stat[t].valuables.indexOf(e)!==-1}},{key:"get_current_symbol",value:function(e){return l["default"].last(this[e])}},{key:"exchange_symbol",value:function(e,t){var n=this[e].length;if(this.pop_symbol(e),this.push_symbol(e,t),this.calc_valuables(e),this.set_exchange_flag(e),this[e].length!==n)throw{msg:"exchange_symbol error langth changed",was:n,is:this[e].length}}},{key:"for_all_symbol_classes",value:function(e){for(var t in this)this[t]instanceof Array&&e(this[t],t)}},{key:"push_symbol",value:function(e,t){return this.do_something_with_symbol(e,t,"push")}},{key:"pop_symbol",value:function(e){return this.do_something_with_symbol(e,null,"pop")}},{key:"advance_array",value:function(e){var t=e.shift();e.push(t)}},{key:"get_exchange_flag",value:function(e){return this.stat[e].exchange_flag}},{key:"set_exchange_flag",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.stat[e].exchange_flag=t}},{key:"do_something_with_symbol",value:function(e,t,n){if(!(this[e]instanceof Array))throw{msg:"bad symbol class",prop:e};var r=this[e].length,a=this[e][n](t),i=this[e].length-r;if(this.stat[e].counters[t]=this.stat[e].counters[t]+i||1,this.stat[e].counters[t]<0)throw{msg:"something wrong with stat",prop:e,stat:this.stat[e]};return a}},{key:"calc_valuables",value:function(e){var t=this.stat[e].counters,n=0,r=Object.keys(t).filter(function(e){return t[e]>Math.max(n-1,1)});r.length==t.length&&(console.log("valuables flush 1"),r=Object.keys(t).filter(function(e){return t[e]>Math.max(n,1)})),r.length==t.length&&(console.log("valuables flush 2"),r=[]),this.stat[e].valuables=r}}]),e}();e["default"]=u}),require.register("chaos/chaos.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{!r&&l["return"]&&l["return"]()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react-dom"),s=a(u),c=t("react"),f=a(c),d=t("redux"),h=t("react-redux"),_=t("common/util"),p=a(_),m=t("chaos/agent"),y=a(m),v=t("chaos/components/app"),g=a(v),b=t("chaos/reducers"),w=a(b),k=t("chaos/actions"),x=r(k),E=function(){function e(){i(this,e),this.x_size=20,this.y_size=20,this.symbols=["✕","✖","✙","✚","✛","✜","✠","✡","✢","✣","✤","✥","✦","✧","✩","✪","✫","✬","✭","✮","✯","✰","✱","✲","✳","✴","✵","✶","✷","✸","✹","✺","✻","✽","✾","✿","❀","❁","❂","❃","❄","❅","❆","❇","❈","❉","❊","❋","❖"],this.symbol_min_weight=8,this.symbol_max_weight=16,this.symbol_classes_min_length=15,this.symbol_classes_max_length=20,this.symbol_classes_count=2,this.init()}return l(e,[{key:"init",value:function(){var e=this,t=[];this.symbols.forEach(function(n){var r=p["default"].rand(e.symbol_min_weight,e.symbol_max_weight);t=t.concat(new Array(r).fill(n))}),this.symbol_classes=Array.from(Array(this.symbol_classes_count),function(){var t=p["default"].rand(e.symbol_classes_min_length,e.symbol_classes_max_length);return Array.from(Array(t),function(){return p["default"].rand_element(e.symbols)})}),this.data=Array.from(Array(this.y_size).keys(),function(t){return Array.from(Array(e.x_size).keys(),function(n){return e.init_agent(n,t)})}),this.store=(0,d.createStore)(w["default"]),this.tick_delay=2e3}},{key:"run",value:function(e){var t=this;e<0||(this.flush_exchange_flags(),this.advance_symbol_classes(),this.exchange_symbols(),this.store.dispatch(x.tick()),setTimeout(function(){return t.run(--e)},this.tick_delay))}},{key:"init_agent",value:function(e,t){var n=new y["default"](e,t);return this.symbol_classes.forEach(function(e,t){n.add_symbol_class("sc"+t,e,p["default"].rand(0,e.length))}),n}},{key:"for_all_agents",value:function(e){this.data.forEach(function(t){t.forEach(function(t){e(t)})})}},{key:"advance_symbol_classes",value:function(){this.for_all_agents(function(e){return e.advance_symbol_classes()}),this.store.dispatch(x.advance_symbols_complete())}},{key:"get_neighbors",value:function(e){var t=this,n=[[e.x-1,e.y],[e.x+1,e.y],[e.x,e.y-1],[e.x,e.y+1]],r=[];return n.forEach(function(e){var n=o(e,2),a=n[0],i=n[1];t.data[i]&&t.data[i][a]&&r.push(t.data[i][a])}),r}},{key:"flush_exchange_flags",value:function(){this.for_all_agents(function(e){e.for_all_symbol_classes(function(t,n){e.set_exchange_flag(n,!1)})})}},{key:"exchange_symbols",value:function(){var e=this;this.for_all_agents(function(t){t.for_all_symbol_classes(function(n,r){if(t.are_you_gonna_exchange(r)){var a=e.get_neighbors(t);if(a=a.filter(function(e){return e.get_current_symbol(r)!==t.get_current_symbol(r)}),a=a.filter(function(e){return e.are_you_gonna_exchange(r)}),a.length){var i=a.filter(function(e){return t.is_valuable_symbol(e.get_current_symbol(r),r)});i.length&&(a=i);var o=p["default"].rand_element(a),l=t.get_current_symbol(r),u=o.get_current_symbol(r);t.exchange_symbol(r,u),o.exchange_symbol(r,l)}}})}),this.store.dispatch(x.exchange_symbols_complete())}}]),e}(),j=new E;e["default"]=j,j.run(5),document.addEventListener("DOMContentLoaded",function(){s["default"].render(f["default"].createElement(h.Provider,{store:j.store},f["default"].createElement(g["default"],null)),document.querySelector("#app"))})}),require.register("chaos/components/app.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=t("chaos/components/grid_container"),f=r(c),d=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return s["default"].createElement("div",{className:"panel-group"},s["default"].createElement("div",{className:"panel panel-success"},s["default"].createElement("div",{className:"panel-body"},s["default"].createElement("div",{className:"",id:"view_container"},s["default"].createElement(f["default"],null)))))}}]),t}(s["default"].Component);e["default"]=d}),require.register("chaos/components/grid.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){var e="30px";return s["default"].createElement("table",null,s["default"].createElement("tbody",null,this.props.data.map(function(t,n){return s["default"].createElement("tr",{key:"y"+n},t.map(function(t,n){return s["default"].createElement("td",{key:"x"+n,style:{borderCollapse:"collapse",border:"1px solid black",width:e,height:e,textAlign:"center"}},s["default"].createElement("span",{style:{fontSize:"20px"}},t.symbol))}))})))}}]),t}(s["default"].Component);e["default"]=c}),require.register("chaos/components/grid_container.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0});var a=t("react-redux"),i=t("chaos/components/grid"),o=r(i),l=t("chaos/chaos"),u=r(l),s=function(e){return console.log("mapStateToProps.",e),{data:u["default"].data.map(function(e){return e.map(function(e){return{symbol:e.get_current_symbol("sc1")}})})}},c=function(){return{on_element_click:function(e){console.log("dont believe it works!!! click on",e)}}},f=(0,a.connect)(s,c)(o["default"]);e["default"]=f}),require.register("chaos/reducers.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.phase,t=arguments[1];switch(t.type){case u.ADVANCE_SYMBOLS_COMPLETE:return"exchange";case u.EXCHANGE_SYMBOLS_COMPLETE:return"wait";default:return e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.tick,t=arguments[1];switch(t.type){case u.TICK:return e+1;default:return e}}Object.defineProperty(e,"__esModule",{value:!0});var o=t("redux"),l=t("chaos/actions"),u=r(l),s={phase:null,tick:0},c=(0,o.combineReducers)({phase:a,tick:i});e["default"]=c}),require.register("common/a_star.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r(this,e),this.getNeighboursFunc=t,this.euristicFunc=n||e.standardEuristic,this.euristicWeight=a,this.pointIndexFunc=i}return a(e,[{key:"find",value:function(e,t){var n={},r={};return this.addToOpenList(e,0,null,n),this.counter=0,this.step(n,r,t)}},{key:"step",value:function(e,t,n){if(this.counter++,this.counter>1e4)throw"counter overflow";if(this.openListIsEmpty(e))return!1;for(var r=this.popPointFromOpenList(e),a=this.getNeighboursFunc(r.point),i=0;i<a.length;i++){var o=a[i],l=o.weight+r.weight+this.euristicWeight*this.euristicFunc(o.point,n);if(o.point==n){for(var u=[o.point,r.point],s=r;null!=s.parent;)u.push(s.parent.point),s=s.parent;return u}if(this.checkPointInClosedList(o,t));else{var c=this.getFromOpenList(o,e);c?(c.parent=r,c.weight=l):this.addToOpenList(o.point,l,r,e)}}return this.addToClosedList(r,t),this.step(e,t,n)}},{key:"listKey",value:function(e){return this.pointIndexFunc?this.pointIndexFunc(e.point):e.point.location.x+"|"+e.point.location.y}},{key:"addToOpenList",value:function(e,t,n,r){var a={point:e,weight:t,parent:n};r[this.listKey(a)]=a}},{key:"openListIsEmpty",value:function(e){return 0==Object.keys(e).length}},{key:"getFromOpenList",value:function(e,t){return t[this.listKey(e)]}},{key:"popPointFromOpenList",value:function(e){var t={},n=void 0;for(var r in e)(e[r].weight<t.weight||!t.weight)&&(t=e[r],n=r);return delete e[n],t}},{key:"addToClosedList",value:function(e,t){t[this.listKey(e)]=e}},{key:"checkPointInClosedList",value:function(e,t){return void 0!=t[this.listKey(e)]}}],[{key:"standardEuristic",value:function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}}]),e}();e["default"]=i}),require.register("common/color.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{!r&&l["return"]&&l["return"]()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=r(l),s=function(){function e(){a(this,e)}return o(e,null,[{key:"random_near",value:function(t){var n=i(t,3),r=n[0],a=n[1],o=n[2],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return e.for_rgb([r,a,o],function(t){return e.random_channel(t,l,u)})}},{key:"random",value:function(t){var n=i(t,3),r=n[0],a=n[1],o=n[2],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e.for_rgb([r,a,o],function(t){return e.random_by_floor(t,l)})}},{key:"brighter",value:function(e){var t=i(e,3),n=t[0],r=t[1],a=t[2],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return[n,r,a].map(function(e){return Math.min(e+o,255)})}},{key:"darker",value:function(e){var t=i(e,3),n=t[0],r=t[1],a=t[2],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return[n,r,a].map(function(e){return Math.max(e-o,0)})}},{key:"to_pixi",value:function(e){var t=i(e,3),n=t[0],r=t[1],a=t[2];return(n<<16)+(r<<8)+a}},{key:"for_rgb",value:function(e,t){var n=i(e,3),r=n[0],a=n[1],o=n[2];return[t(r),t(a),t(o)]}},{key:"random_channel",value:function(e,t,n){var r=t*u["default"].rand(-n,n),a=e+r;return a>255?255:a<0?0:a}},{key:"random_by_floor",value:function(e,t){return e-t*u["default"].rand(0,e/t|0)}}]),e}();e["default"]=s}),require.register("common/components/active_checkbox.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={checked:e.checked},console.log("SUKA",n.state),n}return o(t,e),l(t,[{key:"handler",value:function(e){var t=this.props.handler(e);this.setState({checked:t})}},{key:"render",value:function(){return s["default"].createElement("div",{className:"form-check"},s["default"].createElement("label",{className:"form-check-label"},s["default"].createElement("input",{className:"form-check-input",type:"checkbox",onChange:this.handler.bind(this),defaultChecked:this.state.checked})," ",this.props.text))}}]),t}(s["default"].Component);e["default"]=c}),require.register("common/components/collapsible_panel.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.header=e.header,n.name=e.name,n.content_func=e.content_func,n}return o(t,e),l(t,[{key:"render",value:function(){return s["default"].createElement("div",{className:"panel panel-success"},s["default"].createElement("div",{className:"panel-heading"},s["default"].createElement("h4",{className:"panel-title"},s["default"].createElement("a",{"data-toggle":"collapse",href:"#"+this.name},this.header," ",s["default"].createElement("span",{className:"caret"})))),s["default"].createElement("div",{id:this.name,className:"panel-collapse collapse"},s["default"].createElement("div",{className:"panel-body"},this.content_func())))}}]),t}(s["default"].Component);e["default"]=c}),require.register("common/components/input_spinner.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={value:e.value},n.name=e.name,n.min=e.min?e.min:0,n.max=e.max?e.max:1/0,n}return o(t,e),l(t,[{key:"click_up",value:function(e){return!(this.state.value>=this.max)&&(this.update_value(this.state.value+1),void e.preventDefault())}},{key:"click_down",value:function(e){return!(this.state.value<=this.min)&&(this.update_value(this.state.value-1),void e.preventDefault())}},{key:"manual_set",value:function(e){this.update_value(e.target.value)}},{key:"update_value",value:function(e){this.setState({value:e})}},{key:"render",value:function(){return s["default"].createElement("div",{className:"input-group"},s["default"].createElement("span",{className:"input-group-btn"},s["default"].createElement("a",{className:"btn btn-danger",onClick:this.click_down.bind(this)},s["default"].createElement("span",{className:"glyphicon glyphicon-minus"}))),s["default"].createElement("input",{id:this.name,type:"text",className:"form-control text-center",value:this.state.value,onChange:this.manual_set.bind(this)}),s["default"].createElement("span",{className:"input-group-btn"},s["default"].createElement("a",{className:"btn btn-info",onClick:this.click_up.bind(this)},s["default"].createElement("span",{className:"glyphicon glyphicon-plus"}))))}}]),t}(s["default"].Component);e["default"]=c}),require.register("common/util.js",function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e)}return a(e,null,[{key:"exec_in_cycle_with_delay",value:function(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};return"function"==typeof n&&!n()||t>=n?void i(t):(a(t),void setTimeout(function(){e.exec_in_cycle_with_delay(t+1,n,r,a,i)},r))}},{key:"rand",value:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}},{key:"rand_element",value:function(t){return 0!=t.length&&t[e.rand(0,t.length-1)]}},{key:"rand_float",value:function(e,t){return Math.random()*(t-e)+e}},{key:"normalize_value",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(e>t||e<r)throw console.log("value out of range",e,t,n,r,a),"value out of range";return(e-r)*(n-a)/(t-r)+a}},{key:"last",value:function(e){return 0!=e.length&&e[e.length-1]}},{key:"push_uniq",value:function(e,t){t.indexOf(e)==-1&&t.push(e)}},{key:"merge",value:function(t,n){n.forEach(function(n){return e.push_uniq(n,t)})}},{key:"remove_element",value:function(e,t){var n=t.indexOf(e);return n!==-1&&(t.splice(n,1),!0)}},{key:"for_all_consecutive_pairs",value:function(e,t){if(e.length<2)return!1;for(var n=0;n<e.length;n++){var r=e[n],a=n+1==e.length?0:n+1,i=e[a];t(r,i,n,a)}}},{key:"find_min_and_max",value:function(e,t){if(!e.length)return!1;var n={min:null,max:null,min_element:null,max_element:null};return e.forEach(function(e){var r=t(e);if(!isNaN(r)&&null!==r){if(null==n.min||null==n.max)return n.min=r,n.max=r,n.min_element=e,void(n.max_element=e);r<n.min&&(n.min=r,n.min_element=e),r>n.max&&(n.max=r,n.max_element=e)}}),n}},{key:"do_while_not_empty",value:function(e,t){var n=void 0,r=0;do if(n=e.length,e=e.filter(function(e){return!t(e,r++)}),n==e.length)return console.log("do_while_not_empty() open_list length not chenged, bailing out",n,e),!1;while(e.length);return!0}},{key:"to_polar_coords",value:function(e,t){var n=Math.sqrt(e*e+t*t),r=Math.atan2(t,e);return{angle:r,radius:n}}},{key:"from_polar_coords",value:function(e,t){var n=t*Math.cos(e),r=t*Math.sin(e);return{x:n,y:r}}},{key:"radians",value:function(e){return e*Math.PI/180}},{key:"degrees",value:function(e){return 180*e/Math.PI}},{key:"angles_diff",value:function(e,t){var n=Math.abs(e-t);return Math.min(n,2*Math.PI-n)}},{key:"move_by_vector",value:function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}}},{key:"convex_polygon_centroid",value:function(e){for(var t=e[0],n=0,r=0,a=0,i=1;i<e.length-1;i++){var o=e[i],l=e[i+1],u=((t.x-l.x)*(o.y-l.y)-(o.x-l.x)*(t.y-l.y))/2;n+=u,r+=u*(t.x+o.x+l.x)/3,a+=u*(t.y+o.y+l.y)/3}return{x:r/n,y:a/n}}},{key:"convex_polygon_square",value:function(e){for(var t=e[0],n=0,r=1;r<e.length-1;r++){var a=e[r],i=e[r+1];n+=Math.abs((t.x-i.x)*(a.y-i.y)-(a.x-i.x)*(t.y-i.y))/2}return n}},{key:"distance",value:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}},{key:"gauss_function",value:function(e,t,n){return 1/(t*Math.sqrt(2*Math.PI))*Math.pow(Math.E,-(Math.pow(e-n,2)/(2*Math.pow(t,2))))}}]),e}();e["default"]=i}),require.register("common/voronoi_diagram.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=a(l),s=t("d3"),c=r(s),f=function(){function e(){i(this,e)}return o(e,null,[{key:"generate",value:function(t,n,r){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=c.voronoi().x(function(e){return e.x}).y(function(e){return e.y}).size([n,r]),o=i(t),l=0;l<a;l++)o=e.lloyd_relaxation(o,i);var s={};return s.nodes=[],s.edges=o.edges.map(function(t){var n=void 0,r=void 0;return s.nodes.forEach(function(a){e.seems_like_nodes_are_equal(a,t[0])&&(n=a),e.seems_like_nodes_are_equal(a,t[1])&&(r=a)}),n||(n={x:t[0][0],y:t[0][1],cells:[],links:[]},s.nodes.push(n)),r||(r={x:t[1][0],y:t[1][1],cells:[],links:[]},s.nodes.push(r)),u["default"].push_uniq(r,n.links),r.links.push(n),u["default"].push_uniq(n,r.links),u["default"].push_uniq(t.left.data,n.cells),u["default"].push_uniq(t.left.data,r.cells),t.right&&(u["default"].push_uniq(t.right.data,n.cells),u["default"].push_uniq(t.right.data,r.cells)),{from:n,to:r,left:t.left.data,right:t.right?t.right.data:void 0}}),s.cells=o.cells.map(function(e){var t=e.site.data;return t.nodes=s.nodes.filter(function(e){return e.cells.indexOf(t)!=-1}),t.nodes.sort(function(e,n){var r=u["default"].to_polar_coords(e.x-t.x,e.y-t.y).angle,a=u["default"].to_polar_coords(n.x-t.x,n.y-t.y).angle;return r-a}),t.halfedges=e.halfedges,t.index=e.site.index,t.x=e.site[0],t.y=e.site[1],t}),s.cells.forEach(function(e){var t=[];e.halfedges.forEach(function(n){var r=s.edges[n],a=r.left==e?r.right:r.left;a&&u["default"].push_uniq(s.cells[a.index],t)}),t.sort(function(t,n){return u["default"].distance(e,t)-u["default"].distance(e,n)}),e.links=t}),s.width=n,s.height=r,s.nodes.forEach(function(e){if(e.links.length<2)throw console.log("a little split",e.x,e.y,e.links),"ITS TOTAL DISASTER voronoi diagram"}),s}},{key:"find",value:function(e,t){return u["default"].find_min_and_max(t.cells,function(t){return u["default"].distance(e,t)}).min_element}},{key:"lloyd_relaxation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.polygons().map(function(e){var t=e.map(function(e){return{x:e[0],y:e[1]}}),r=u["default"].convex_polygon_centroid(t);return u["default"].move_by_vector(e.data,r,n)});return t(r)}},{key:"seems_like_nodes_are_equal",value:function(e,t){var n=1e-13;return Math.abs(e.x-t[0])<n&&Math.abs(e.y-t[1])<n}}]),e}();e["default"]=f}),require.register("experimental/basic_drawer.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=(a(l),t("common/color")),s=a(u),c=t("d3"),f=r(c),d=t("experimental/components/app"),h=a(d),_=t("react-dom"),p=a(_),m=t("react"),y=a(m),v=t("pixi.js"),g=r(v),b=function(){function e(t){var n=this;i(this,e),this.real_size=800,this.regime=t,this.ticks=0,this.tick_speed=1,this.react_app=y["default"].createElement(h["default"],{additional:this.update_debug_info()}),document.addEventListener("DOMContentLoaded",function(){p["default"].render(n.react_app,document.querySelector("#app")),n.init()})}return o(e,[{key:"init",value:function(){var e=this;if(this.pixi=new g.Application(this.real_size,this.real_size,{
backgroundColor:s["default"].to_pixi([0,0,0]),antialias:!0,view:document.getElementById("view")}),this.pixi.stage.interactive=!0,console.log("renderer",this.pixi.renderer),this.base_container=new g.Container,"square"==this.regime){this.size=100;var t=this.real_size/this.size|0;this.base_container.scale={x:t,y:t}}else{if("circle"!=this.regime)throw this.regime?"unknown regime: "+regime:"regime is not set";this.size=200;var n=this.real_size/this.size|0;this.base_container.scale={x:n,y:n},this.base_container.position.x=this.real_size/2|0,this.base_container.position.y=this.real_size/2|0}this.pixi.stage.addChild(this.base_container),document.getElementById("view_container").appendChild(this.pixi.view),document.addEventListener("mousemove",this.mouse_move_handler.bind(this),!1),this.ticks=0,this.tick_time=0,this.pixi.ticker.add(function(t){e.ticks++,e.ticks%10==0&&(f.select("#fps_counter").html(0|e.pixi.ticker.FPS),e.update_debug_info().forEach(function(e){return document.getElementById(e.id).innerHTML=e.value})),e.tick_delta=t,e.tick_time+=t,e.redraw()}),this.init_graphics()}},{key:"clear_all",value:function(){this.base_container.removeChildren()}},{key:"init_graphics",value:function(){}},{key:"redraw",value:function(){}},{key:"update_debug_info",value:function(){return[]}},{key:"mouse_move_handler",value:function(e){if(e.target!=this.pixi.view)return!1;var t=this.get_mouse_coords(e);f.select("#mouse_pos").html("{x: "+t.x+", y: "+t.y+"}")}},{key:"get_mouse_coords",value:function(e){return{x:e.offsetX,y:e.offsetY}}}]),e}();e["default"]=b}),require.register("experimental/basic_random_tableau.js",function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=t("experimental/tableau_drawer"),i=function(e){return r({},e,{color:Math.random()})},o=function(e,t){return r({},e,{new_color:(e.color+t.color_change_per_tick/256)%1})};(0,a.createTableauDrawer)(i,o)}),require.register("experimental/components/app.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={additional:e.additional?e.additional:[]},n}return o(t,e),l(t,[{key:"go_back",value:function(){window.location.href="./samples_collection.html"}},{key:"render",value:function(){return s["default"].createElement("div",{className:"panel-group"},s["default"].createElement("div",{className:"panel panel-success"},s["default"].createElement("div",{className:"panel-body"},s["default"].createElement("div",{className:"",id:"back_link"},s["default"].createElement("button",{type:"button",className:"btn btn-success btn",onClick:this.go_back},s["default"].createElement("span",{className:"glyphicon glyphicon-triangle-left","aria-hidden":"true"})," back to collection")))),s["default"].createElement("div",{className:"panel panel-success"},s["default"].createElement("div",{className:"panel-body"},s["default"].createElement("div",{className:"",id:"view_container"},s["default"].createElement("canvas",{id:"view",width:"800",height:"800"})))),s["default"].createElement("div",{className:"panel panel-success"},s["default"].createElement("div",{className:"panel-body"},s["default"].createElement("div",null,s["default"].createElement("div",null,"FPS:",s["default"].createElement("span",{id:"fps_counter"})),s["default"].createElement("div",null,"mouse position:",s["default"].createElement("span",{id:"mouse_pos"})),this.state.additional.map(function(e){return s["default"].createElement("div",{key:e.id},e.text,":"," ",s["default"].createElement("span",{id:e.id},e.value))})))))}}]),t}(s["default"].Component);e["default"]=c}),require.register("experimental/components/debug_info.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return s["default"].createElement("div",null,s["default"].createElement("div",null,"FPS:",s["default"].createElement("span",{id:"fps_counter"})),s["default"].createElement("div",null,"map scale:",s["default"].createElement("span",{id:"map_scale"})),s["default"].createElement("div",null,"mouse position:",s["default"].createElement("span",{id:"mouse_pos"},0)),s["default"].createElement("div",null,"world point:",s["default"].createElement("span",{id:"world_pos"},0)))}}]),t}(s["default"].Component);e["default"]=c}),require.register("experimental/components/sample_preview.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0});var a=t("react"),i=r(a),o=function(e){var t=e.status.replace(/_/g," "),n="status_"+e.status;return i["default"].createElement("div",{className:"sample_preview"},i["default"].createElement("div",{className:"panel panel-success",style:{width:220}},i["default"].createElement("div",{className:"panel-heading"},i["default"].createElement("div",{className:"panel-title"},e.name),i["default"].createElement("span",{className:"label label-primary "+n},t)),i["default"].createElement("div",{className:"panel-body"},i["default"].createElement("a",{href:e.sample_url,className:"thumbnail"},i["default"].createElement("img",{alt:"sample preview",width:"200",height:"200",src:e.img_path})),i["default"].createElement("div",null,i["default"].createElement("p",null,e.description)))))};e["default"]=o}),require.register("experimental/components/samples_collection.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=t("experimental/components/sample_preview"),o=r(i),l=t("react"),u=r(l),s=[{name:"moving arrows",description:"schizophreniac arrows moving all around",sample_url:"./moving_arrows.html",img_path:"./thumbnails/moving_arrows.png",status:"almost_ready"},{name:"planets focus",description:"star system emulation, where we\n      dynamically change focus on random stellar body,\n      i.e. move it to the center of coordinates and make all others spin around it",sample_url:"./planets_focus.html",img_path:"./thumbnails/planets_focus.jpg",status:"draft"},{name:"basic random tableau",description:"random start configuration, pixels change their colors with edgy jump from white to black",sample_url:"./basic_tableau.html",img_path:"./thumbnails/basic_tableau.jpg",status:"ready"},{name:"smooth random tableau",description:"random start configuration, pixels change their colors smoothly -- black to white and backward",sample_url:"./smooth_tableau.html",img_path:"./thumbnails/smooth_tableau.jpg",status:"ready"},{name:"rule 30",description:"cellular automaton evolution of rule 30 introduced by stephen wolfram in 1983",sample_url:"./rule_30.html",img_path:"./thumbnails/rule_30.jpg",status:"ready"},{name:"vichniac vote",description:"the color of cell depends on number of black cell in its moore neighborhood and previous\n      self color -- it is black if total numbler black cells is greater than 4",sample_url:"./vichniac_vote.html",img_path:"./thumbnails/vichniac_vote.jpg",status:"ready"},{name:"orbits",description:"experiment with 3d polar functions",sample_url:"./orbits.html",img_path:"./thumbnails/orbits.jpg",status:"draft"},{name:"luna",description:"its like moon -- planet with craters on surface",sample_url:"./luna.html",img_path:"./thumbnails/luna.jpg",status:"ready"},{name:"wavy sphere",description:"sphere with waves",sample_url:"./wavy_sphere.html",img_path:"./thumbnails/wavy_planet.jpg",status:"ready"}],c=function(){return u["default"].createElement("div",{className:"col-md-8 col-md-offset-2"},u["default"].createElement("div",{className:"panel panel-success"},u["default"].createElement("div",{className:"panel-heading"},u["default"].createElement("h4",{className:"panel-title"},"a collection of funny graphics samples")),u["default"].createElement("div",{className:"panel-body"},s.map(function(e){return u["default"].createElement(o["default"],a({},e,{key:e.name}))}))))};e["default"]=c}),require.register("experimental/drawer.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0}),e.createDrawer=void 0;var i=t("common/color"),o=a(i),l=t("d3"),u=r(l),s=t("experimental/components/app"),c=a(s),f=t("react-dom"),d=a(f),h=t("react"),_=a(h),p=t("pixi.js"),m=r(p),y=function(e,t,n,r){var a={ticks:0,tickTime:0,base_container:new m.Container,size:0,tick_delta:0},i=800,l=new m.Application(i,i,{backgroundColor:o["default"].to_pixi([0,0,0]),antialias:!0,view:document.getElementById("view")});if(l.stage.interactive=!0,console.log("renderer",l.renderer),"square"===e){a.size=100;var s=i/a.size||0;a.base_container.scale={x:s,y:s}}else{if("circle"!==e)throw"unknown regime: "+e;a.size=200;var c=i/a.size||0;a.base_container.scale={x:c,y:c},a.base_container.position.x=i/2||0,a.base_container.position.y=i/2||0}var f=function(e){if(e.target!==l.view)return!1;var t={x:e.offsetX,y:e.offsetY};u.select("#mouse_pos").html("{x: "+t.x+", y: "+t.y+"}")};l.stage.addChild(a.base_container),document.getElementById("view_container").appendChild(l.view),document.addEventListener("mousemove",f.bind(void 0),!1),a=n(a),l.ticker.add(function(e){a.ticks+=1,a.ticks%10===0&&(u.select("#fps_counter").html(l.ticker.FPS||0),t(a).forEach(function(e){document.getElementById(e.id)?document.getElementById(e.id).innerHTML=""+e.value:console.log("no element by id "+e.id)})),a.tick_delta=e,a.tickTime+=e,a=r(a)})};e.createDrawer=function(e,t,n,r){d["default"].render(_["default"].createElement("div",{style:{maxWidth:"1280px"}},_["default"].createElement(c["default"],{additional:t({})})),document.body.appendChild(document.createElement("div"))),y(e,t,n,r)}}),require.register("experimental/luna2.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var i=t("common/util"),o=r(i),l=t("experimental/planet_drawer"),u=function(e){for(var t=[],n=50,r=0,i=[],l=function(){if(r+=1,r>1e3)throw"too many cycles";var l=o["default"].rand_float(0,2*Math.PI),u=o["default"].rand_float(0,2*Math.PI),f=o["default"].rand_float(o["default"].radians(1),o["default"].radians(15)),d=e.radius,h=i.some(function(e){var t=f+e.diameter+o["default"].radians(2);return c({precession:l,nutation:u,diameter:f},e)<t});h||(i=[].concat(a(i),[{precession:l,nutation:u,diameter:f}]),t=[].concat(a(t),a(s(d,f,l,u))),n-=1)};n;)l();return t},s=function(e,t,n,r){for(var i=[],o=2*Math.PI/(1500*t),u=0;u<=2*Math.PI;u+=o){var s=(0,l.calcSinglePoint)(e,u,t,0,n,r),c=Math.atan2(Math.sqrt(s.x*s.x+s.y*s.y),s.z),f=Math.atan2(s.y,s.x);i=[].concat(a(i),[{phi:f,theta:c}])}return i},c=function(e,t){var n=(0,l.calcSinglePoint)(1,0,0,0,e.precession,e.nutation),r=(0,l.calcSinglePoint)(1,0,0,0,t.precession,t.nutation),a=n.x*r.x+n.y*r.y+n.z*r.z,i=function(e){return e.x*e.x+e.y*e.y+e.z*e.z},o=Math.sqrt(i(n))*Math.sqrt(i(r));return Math.acos(a/o)};(0,l.createPlanetDrawer)(u)}),require.register("experimental/moving_arrows.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=t("common/util"),u=a(l),s=t("common/color"),c=a(s),f=t("pixi.js"),d=r(f),h=t("experimental/drawer"),_=function(){return[]},p=function(e){var t=o({},e);t.size_coef=7,t.step=t.size/t.size_coef,t.matrix_size=2*t.size,t.arrows=[],t.change_angle_base_threshold=100,t.change_angle_tick=t.change_angle_base_threshold,t.angle=2*Math.PI*Math.random(),t.angle_inc=0,t.angle_inc_max=2*Math.PI/360,t.acceleration=0,t.max_speed=1.2,t.min_speed=.6,t.speed=(t.max_speed-t.min_speed)/2,t.color=[255,255,255],t.matrix_container=new d.Container,t.matrix_container.x=-t.step,t.matrix_container.y=-t.step,t.base_container.addChild(t.matrix_container);for(var n=-2*t.step;n<t.matrix_size;n+=t.step)for(var r=-2*t.step;r<t.matrix_size;r+=t.step){var a=9*t.step,l=new d.Text("➔",{fontFamily:"Arial",fontSize:a,fill:c["default"].to_pixi(t.color)});l.scale={x:.1,y:.1},l.x=r,l.y=n,l.rotation=t.angle,t.arrows=[].concat(i(t.arrows),[l])}return t.arrows.forEach(function(e){return t.matrix_container.addChild(e)}),t},m=function(e){var t=o({},e);if(t.change_angle_tick-=1,t.change_angle_tick<=0){t.change_angle_tick=t.change_angle_base_threshold*(3*Math.random()+.2)||0;var n=y(-t.angle_inc_max,t.angle_inc_max,Math.random());t.angle_inc=t.angle_inc?0:n}t.angle+=t.angle_inc;var r=t.angle_inc_max/2-Math.abs(t.angle_inc),a=t.speed+r;a*=t.tick_delta,t.speed=Math.max(t.min_speed,Math.min(a,t.max_speed));var i=t.speed,l=t.angle,s=u["default"].from_polar_coords(l,i);return t.arrows.forEach(function(e){e.x=(e.x+s.x)%t.matrix_size+(e.x<0?t.matrix_size:0),e.y=(e.y+s.y)%t.matrix_size+(e.y<0?t.matrix_size:0),e.rotation=t.angle}),t},y=function(e,t,n){return e*(1-n)+t*n};(0,h.createDrawer)("square",_,p,m)}),require.register("experimental/orbits.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=t("common/util"),u=a(l),s=t("common/color"),c=a(s),f=t("pixi.js"),d=r(f),h=t("experimental/drawer"),_=function(e){return[{id:"debug_info_precession",text:"precession",value:e.figures?e.figures[0].precession_coef:""},{id:"debug_info_nutation",text:"nutation",value:e.figures?e.figures[0].nutation_coef:""},{id:"debug_info_additional",text:"angle state.acceleration",value:e.acceleration}]},p=function(e){var t=o({},e);return t.count_figures=1,t.figures=[].concat(i(Array(t.count_figures).keys())).map(function(e){var n=new d.Graphics;return t.base_container.addChild(n),{id:e,graphics:n,radius:.45*t.size,precession_coef:.0025*u["default"].rand_float(-3,3),nutation_coef:.0025*u["default"].rand_float(1,3)}}),t},m=function(e){var t=o({},e);return t.acceleration=5*Math.cos(.005*t.tickTime),t.figures.forEach(function(e){return y(e,t)}),t},y=function(e,t){e.graphics.clear();for(var n=72,r=0;r<=2*Math.PI;r+=2*Math.PI/n){var a=v(e.radius,r+t.acceleration,e.precession_coef*t.tickTime,e.nutation_coef*t.tickTime+.5*t.acceleration);e.graphics.beginFill(c["default"].to_pixi([255,255,255])),e.graphics.drawCircle(a.x,a.y,1),e.graphics.endFill()}},v=function(e,t,n,r){var a=e*Math.cos(t)*Math.sin(r),i=e*Math.sin(t),o=Math.sin(n),l=Math.cos(n),u=a*l-i*o,s=a*o+i*l;return{x:u,y:s}};(0,h.createDrawer)("circle",_,p,m)}),require.register("experimental/planet.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=t("common/util"),f=a(c),d=t("common/color"),h=a(d),_=t("experimental/basic_drawer"),p=a(_),m=t("pixi.js"),y=r(m),v=function(e){function t(){return o(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"circle"))}return u(t,e),s(t,[{key:"update_debug_info",value:function(){return[{id:"debug_info_precession",text:"precession",value:Math.round(f["default"].degrees(this.precession))},{id:"debug_info_nutation",text:"nutation",value:Math.round(f["default"].degrees(this.nutation))},{id:"debug_info_rotation",text:"rotation",value:Math.round(f["default"].degrees(this.rotation))},{id:"debug_info_count_points",text:"count points",value:this.points?this.points.length:0}]}},{key:"init_graphics",value:function(){if(this.planet=new y.Container,this.base_container.addChild(this.planet),this.radius=.45*this.size,this.rotation=null,this.precession=null,this.nutation=null,this.points=this.init_graphics_from_sphere_map(this.sphere_map()),this.map_transparency_alpha=.25,this.draw_contour=!0,this.draw_contour){var e=new y.Graphics;e.lineStyle(1,h["default"].to_pixi([255,255,255])),e.drawCircle(0,0,this.radius),this.base_container.addChild(e)}}},{key:"redraw",value:function(){var e=this;this.change_angles(this.ticks),this.points.forEach(function(t){var n=e.calc_single_point(e.radius,t.phi,t.theta,e.rotation,e.precession,e.nutation);t.graphics.alpha=n.z<0?e.map_transparency_alpha:1,t.graphics.x=n.x,t.graphics.y=n.y})}},{key:"calc_single_point",value:function(e,t,n,r,a,i){var o=e*Math.cos(t)*Math.sin(n),l=e*Math.sin(t)*Math.sin(n),u=e*Math.cos(n),s=Math.sin(r),c=Math.cos(r),f=Math.sin(a),d=Math.cos(a),h=Math.sin(i),_=Math.cos(i),p=_*s,m=_*c,y=o*(d*c-f*p)+l*(-d*s-f*m)+u*(f*h),v=o*(f*c+d*p)+l*(-f*s+d*m)+u*(-d*h),g=o*(h*s)+l*(h*c)+u*_;return{x:y,y:v,z:g}}},{key:"change_angles",value:function(e){this.rotation=f["default"].radians(0)+e*(2*Math.PI/360),this.precession=f["default"].radians(30)+f["default"].radians(15)*Math.sin(2*e/360),this.nutation=f["default"].radians(60)+f["default"].radians(15)*Math.cos(2*e/360)}},{key:"sphere_map",value:function(){return[].concat(i(Array(500).keys())).map(function(e){return{phi:f["default"].rand_float(0,2*Math.PI),theta:f["default"].rand_float(0,2*Math.PI)}})}},{key:"init_graphics_from_sphere_map",value:function(e){var t=this;return e.map(function(e){return e.graphics=new y.Graphics,e.graphics.beginFill(h["default"].to_pixi([255,255,255]),1),e.graphics.drawRect(0,0,.0025*t.size,.0025*t.size),e.graphics.endFill(),t.planet.addChild(e.graphics),e})}}]),t}(p["default"]);e["default"]=v}),require.register("experimental/planet_drawer.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.createPlanetDrawer=e.calcSinglePoint=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=t("common/util"),u=a(l),s=t("common/color"),c=a(s),f=t("pixi.js"),d=r(f),h=t("experimental/drawer"),_=e.calcSinglePoint=function(e,t,n,r,a,i){var o=e*Math.cos(t)*Math.sin(n),l=e*Math.sin(t)*Math.sin(n),u=e*Math.cos(n),s=Math.sin(r),c=Math.cos(r),f=Math.sin(a),d=Math.cos(a),h=Math.sin(i),_=Math.cos(i),p=_*s,m=_*c,y=o*(d*c-f*p)+l*(-d*s-f*m)+u*(f*h),v=o*(f*c+d*p)+l*(-f*s+d*m)+u*(-d*h),g=o*(h*s)+l*(h*c)+u*_;return{x:y,y:v,z:g}},p=(e.createPlanetDrawer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25;return(0,h.createDrawer)("circle",p,function(n){return v(n,e,t)},g)},function(e){return[{id:"debug_info_precession",text:"precession",value:Math.round(u["default"].degrees(e.precession))},{id:"debug_info_nutation",text:"nutation",value:Math.round(u["default"].degrees(e.nutation))},{id:"debug_info_rotation",text:"rotation",value:Math.round(u["default"].degrees(e.rotation))},{id:"debug_info_count_points",text:"count points",value:e.points?e.points.length:0}]}),m=function(){return[].concat(i(Array(500).keys())).map(function(){return{phi:u["default"].rand_float(0,2*Math.PI),theta:u["default"].rand_float(0,2*Math.PI)}})},y=function(e,t){return e.map(function(e){var n=o({},e,{graphics:new d.Graphics});return n.graphics.beginFill(c["default"].to_pixi([255,255,255]),1),n.graphics.drawRect(0,0,.0025*t.size,.0025*t.size),n.graphics.endFill(),t.planet.addChild(n.graphics),n})},v=function(e,t,n){var r=o({},e);if(r.planet=new d.Container,r.base_container.addChild(r.planet),r.radius=.45*r.size,r.rotation=null,r.precession=null,r.nutation=null,r.points=y(t(r),r),r.map_transparency_alpha=n,r.draw_contour=!0,r.draw_contour){var a=new d.Graphics;a.lineStyle(1,c["default"].to_pixi([255,255,255])),a.drawCircle(0,0,r.radius),r.base_container.addChild(a)}return r},g=function(e){var t=o({},e);return t.rotation=u["default"].radians(0)+t.ticks*(2*Math.PI/360),t.precession=u["default"].radians(30)+u["default"].radians(15)*Math.sin(2*t.ticks/360),t.nutation=u["default"].radians(60)+u["default"].radians(15)*Math.cos(2*t.ticks/360),t.points.forEach(function(e){var n=_(t.radius,e.phi,e.theta,t.rotation,t.precession,t.nutation);e.graphics.alpha=n.z<0?t.map_transparency_alpha:1,e.graphics.x=n.x,e.graphics.y=n.y}),t}}),require.register("experimental/planet_exp.js",function(e,t,n){"use strict";var r=t("experimental/planet_drawer"),a=function(){for(var e=[],t=5*Math.PI/360,n=0,r=2*Math.PI/t||0,a=0;a<2*Math.PI;a+=t){var i=2*Math.min(n,r-n)+1,o=2*Math.PI/i;console.log("phi_step",n,i);for(var l=0;l<2*Math.PI;l+=o)e.push({phi:l,theta:a});n+=1}return e};(0,r.createPlanetDrawer)(a,0)}),require.register("experimental/planet_exp_2.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var a=t("common/util"),i=r(a),o=t("experimental/planet_drawer"),l=function(e,t,n){for(var r=[],a=1e3,i=0;i<2*Math.PI;i+=2*Math.PI/a){var o=t+e*Math.sin(n*i),l=i;r.push({phi:l,theta:o})}return r},u=function(){for(var e=[],t=2*Math.PI/36,n=i["default"].rand_float(.1*t,.5*t),r=i["default"].rand(2,10),a=1*t;a<2*Math.PI/2-t;a+=t)r=a/t||0,e=e.concat(l(n,a,r));return e};(0,o.createPlanetDrawer)(u,0)}),require.register("experimental/planets_focus.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=t("common/util"),l=a(o),u=t("common/color"),s=a(u),c=t("pixi.js"),f=r(c),d=t("d3"),h=r(d),_=t("ramda"),p=r(_),m=t("experimental/drawer"),y=function(e){var t=i({},e);return t.matrix=new f.Container,t.base_container.addChild(t.matrix),t.star=k(t,"star",null,0,10,0,.5),t.planet1=k(t,"planet1",t.star,20,3,1,0),t.moon1=k(t,"moon1",t.planet1,6,1,2,2),t.planet2=k(t,"planet2",t.star,40,5,2,3),t.moon21=k(t,"moon21",t.planet2,8,2,3,.1),t.moon22=k(t,"moon22",t.planet2,12,1,4,1),t.bodies=[t.star,t.planet1,t.moon1,t.planet2,t.moon21,t.moon22],t.forced_focus=!1,t.focused_body=t.bodies[0],t.focus_change_threshold=300,t.focus_change_tick=t.focus_change_threshold,t=b(t)},v=function(e){var t=i({},e);if(t.bodies=t.bodies.map(function(e){var n=i({},e);return n.orbital_angle+=t.tick_delta*n.orbital_speed,n.angle+=t.tick_delta*(n.orbital_speed+n.rotation_speed),x(n)}),t.focus_change_tick-=1,t.focus_change_tick<=0&&(t.focus_change_tick=t.focus_change_threshold,!t.forced_focus)){var n=g(t.focused_body)(t.bodies);t.focused_body=t.bodies[n===t.bodies.length-1?0:n+1],console.log("now focus on",t.focused_body.name)}return t=b(t),h.select("#debug_info_focus_on").html(t.focused_body.name),t},g=function(e){return p.findIndex(function(t){return t.name===e.name})},b=function(e){var t=i({},e),n=w(t.focused_body);return t.matrix.position.x=-n.x,t.matrix.position.y=-n.y,t},w=function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=l["default"].from_polar_coords(e.orbital_angle,e.orbital_radius);return t.x+=n.x,t.y+=n.y,e.parent?E(e.parent,t):t},k=function(e,t,n,r,a,i,o){var u=1.5,c=!1,d=!1,h=u*a,_=new f.Graphics,p=new f.Graphics;_.addChild(p),p.lineStyle(h/10,s["default"].to_pixi([255,255,255])),p.drawCircle(0,0,h),p.closePath(),[1,2,3].forEach(function(e){var t=l["default"].from_polar_coords(2*e*Math.PI/3,h/2);p.drawCircle(t.x,t.y,h/4),p.closePath()});var m={base_container:_,graphics:p,name:t,parent:n,orbital_radius:u*r,radius:h,orbital_speed:l["default"].radians(i),rotation_speed:l["default"].radians(o),orbital_angle:c||2*Math.PI*Math.random(),angle:d||2*Math.PI*Math.random()};m=x(m);var y=n?n.base_container:e.matrix;return y.addChild(m.base_container),m},x=function(e){var t=i({},e),n=l["default"].from_polar_coords(t.orbital_angle,t.orbital_radius);return t.base_container.x=n.x,t.base_container.y=n.y,t.graphics.rotation=t.angle,t};(0,m.createDrawer)("circle",function(){return[]},y,v)}),require.register("experimental/rule_30.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=t("common/util"),o=r(i),l=t("experimental/tableau_drawer"),u=function(e){return a({},e,{color:0})},s=function(e,t){var n=0;if(e.y===t.y_size-1){var r=(0,l.getElementColor)(e.x-1,e.y,t,c),i=(0,l.getElementColor)(e.x+1,e.y,t,c),o=e.color;n=f(r,i,o)}else n=t.data[e.y+1][e.x].color;return a({},e,{new_color:n})},c=function(){return o["default"].rand(0,1)},f=function(e,t,n){switch(""+e+t+n){case"111":case"110":case"101":return 0;case"100":case"011":case"010":case"001":return 1;case"000":return 0;default:throw{msg:"unknown pattern",pattern:[e,t,n]}}};(0,l.createTableauDrawer)(u,s,3)}),require.register("experimental/samples_collection_init.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var a=t("react-dom"),i=r(a),o=t("react"),l=r(o),u=t("experimental/components/samples_collection"),s=r(u);i["default"].render(l["default"].createElement("div",{style:{margin:"20px"}},l["default"].createElement(s["default"],null)),document.body.appendChild(document.createElement("div")))}),require.register("experimental/tableau.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=t("common/util"),c=a(s),f=t("common/color"),d=a(f),h=t("experimental/basic_drawer"),_=a(h),p=t("pixi.js"),m=r(p),y=function(e){function t(){i(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"square"));return e.x_size=100,e.y_size=100,e}return l(t,e),u(t,[{key:"init_graphics",value:function(){this.color_change_per_tick=8,this.data=[];for(var e=Math.min(this.size/this.x_size,this.size/this.y_size),t=0;t<this.y_size;t++){this.data[t]=[];for(var n=0;n<this.x_size;n++){var r=new m.Graphics;r.beginFill(d["default"].to_pixi([255,255,255])),r.drawRect(c["default"].normalize_value(n,this.x_size,this.size),c["default"].normalize_value(t,this.y_size,this.size),e,e),r.endFill(),this.base_container.addChild(r),this.data[t][n]={x:n,y:t,color:0,new_color:0,graphics:r}}}this.init_state(),this.update_cells()}},{key:"redraw",value:function(){this.mutate_state(),this.update_cells()}},{key:"update_cells",value:function(){this.for_all_elements(function(e){return e.graphics.alpha=e.color})}},{key:"for_all_elements",value:function(e){this.data.forEach(function(t){t.forEach(function(t){e(t)})})}},{key:"init_state",value:function(){var e=this;this.for_all_elements(function(t){return e.init_element_state(t)})}},{key:"init_element_state",value:function(e){e.color=Math.random()}},{key:"mutate_state",value:function(){var e=this;this.for_all_elements(function(t){return e.mutate_element_state(t)}),this.for_all_elements(function(e){return e.color=e.new_color;
})}},{key:"mutate_element_state",value:function(e){e.new_color=(e.color+this.color_change_per_tick/256)%1}},{key:"get_element_color",value:function(e,t,n){return this.data[t]&&this.data[t][e]?this.data[t][e].color:n(e,t)}}]),t}(_["default"]);e["default"]=y}),require.register("experimental/tableau_drawer.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0}),e.createTableauDrawer=e.getElementColor=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=t("common/util"),l=a(o),u=t("common/color"),s=a(u),c=t("pixi.js"),f=r(c),d=t("experimental/drawer"),h=(e.getElementColor=function(e,t,n,r){return n.data[t]&&n.data[t][e]?n.data[t][e].color:r()},e.createTableauDrawer=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;(0,d.createDrawer)("square",function(){return[]},function(t){return h(t,e,n,r,a,i)},function(n){return _(n,t,e)})},function(e,t,n,r,a,o){var u=i({},e);u.throttle=n,u.cyclesLimit=r,u.x_size=a,u.y_size=o,u.color_change_per_tick=8,u.data=[];for(var c=Math.min(u.size/u.x_size,u.size/u.y_size),d=0;d<u.y_size;d+=1){u.data[d]=[];for(var h=0;h<u.x_size;h+=1){var _=new f.Graphics;_.beginFill(s["default"].to_pixi([255,255,255])),_.drawRect(l["default"].normalize_value(h,u.x_size,u.size),l["default"].normalize_value(d,u.y_size,u.size),c,c),_.endFill(),u.base_container.addChild(_),u.data[d][h]={x:h,y:d,color:0,new_color:0,graphics:_}}}return u=y(u,t),u=p(u)}),_=function(e,t,n){var r=i({},e);return r=v(r,t,n),r=p(r)},p=function(e){return m(function(e){return e.graphics.alpha=e.color,e},e)},m=function(e,t){var n=t.data.map(function(t){return t.map(function(t){return e(t)})});return i({},t,{data:n})},y=function(e,t){return m(function(n){return t(n,e.color_change_per_tick)},e)},v=function(e,t,n){var r=i({},e);return r.cyclesLimit&&r.ticks%(r.cyclesLimit*r.throttle)===1?y(r,n):r.ticks%r.throttle!==0?r:(r=m(function(e){return t(e,r)},r),r=m(function(e){return e.color=e.new_color,e},r))}}),require.register("experimental/tableau_smooth.js",function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=t("experimental/tableau_drawer"),i=function(e){return r({},e,{color:Math.random(),sign:1})},o=function(e,t){var n=r({},e);return n.color<=0?n.sign=1:n.color>=1&&(n.sign=-1),n.new_color=n.color+n.sign*(t.color_change_per_tick/256),n.new_color=Math.max(0,n.new_color),n.new_color=Math.min(1,n.new_color),n};(0,a.createTableauDrawer)(i,o)}),require.register("experimental/texture_generators/blur_generator.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=t("common/color"),s=r(u),c=function(){function e(){a(this,e),this.map=game.map_drawer.map,this.exp_container=new PIXI.Container,this.map.stage.addChild(this.exp_container)}return i(e,[{key:"exp_dots",value:function(){var e=this,t=.005,n=t*this.map.view.width*this.map.view.height,r=.03,a=r*Math.min(this.map.view.width,this.map.view.height),i=n*r,o=10;console.log("points_count",n,"radius",a,"count_near_threshold",i);for(var u=[];n--;)u.push({x:l["default"].rand(0,this.map.view.width),y:l["default"].rand(0,this.map.view.height)});for(var c=[60,30,0];--o;)c=s["default"].brighter(c,20),this.exp_dots_step(a,i/o|0,u,c);u.forEach(function(t){return e.exp_dots_draw_circle(t.x,t.y,2,[200,100,0])})}},{key:"exp_dots_step",value:function(e,t,n,r){var a=this;console.log("exp_dots_step radius",e,"threshold",t);var i=10;n.forEach(function(o){var l=a.exp_dots_count_near(o,e,n);i+=l,l>=t&&a.exp_dots_draw_circle(o.x,o.y,e,r)}),console.log("near mid",i/n.length)}},{key:"exp_dots_draw_circle",value:function(e,t,n,r){var a=new PIXI.Graphics;a.beginFill(s["default"].to_pixi(r)),a.drawCircle(e,t,n),a.closePath(),a.endFill(),this.exp_container.addChild(a)}},{key:"exp_dots_count_near",value:function(e,t,n){var r=n.filter(function(n){return l["default"].distance(e,n)<=t});return r.length-1}}]),e}();e["default"]=c}),require.register("experimental/texture_generators/density_map.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=a(l),s=t("common/color"),c=a(s),f=t("d3"),d=(r(f),function(){function e(){i(this,e),this.reject_limit=500,this.average_distance_threshold=.05,this.zero_distance_sum=0}return o(e,[{key:"random_point",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{x:2*Math.random()-1,y:2*Math.random()-1,initial:e}}},{key:"generate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=this.reject_limit,r=0;for(this.points=[];t;){var a=this.random_point(!0);this.check_in_circle(a)&&(this.points.push(a),t--)}for(;this.points.length<e;){var i=this.random_point(!1);if(this.check_in_circle(i)&&(this.check_average_distance(i)?(n=this.reject_limit,this.points.push(i),this.zero_distance_sum+=u["default"].distance(i,{x:0,y:0})):(n--,r++),!n)){console.log("DensityMap.generate() reject limit "+this.reject_limit+" reached, bailing out");break}}return console.log("done, total_rejects: ",r),!0}},{key:"check_in_circle",value:function(e){return u["default"].distance(e,{x:0,y:0})<=1}},{key:"calc_distance_sum",value:function(e){return this.points.reduce(function(t,n){return t+u["default"].distance(e,n)},0)}},{key:"check_average_distance",value:function(e){var t=u["default"].find_min_and_max(this.points,function(t){return u["default"].distance(t,e)}).min,n=t*Math.pow(Math.random(),100);return t<this.average_distance_threshold+n}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.draw_naive.bind(this),n=new PIXI.Graphics;return t(e,n),n}},{key:"draw_naive",value:function(e,t){var n=.01;this.points.forEach(function(r){var a=r.initial?[125,255,0]:[125,0,0];t.beginFill(c["default"].to_pixi(a)),t.drawCircle(e*r.x,e*r.y,e*n),t.closePath(),t.endFill()})}},{key:"draw_density_grid",value:function(e,t){for(var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,a=2/r,i=[],o=function(e){for(var t=function(t){var r={x:t,y:e,density:0};return n.check_in_circle(r)?(r.density=n.points.filter(function(n){return n.x>=t&&n.y>=e&&n.x<t+a&&n.y<e+a}).length,void i.push(r)):"continue"},r=-1;r<1;r+=a){t(r)}},l=-1;l<1;l+=a)o(l);var s=u["default"].find_min_and_max(i,function(e){return e.density}).max;i.forEach(function(n){var r=u["default"].normalize_value(n.density,s,255,0,20);t.beginFill(c["default"].to_pixi([r,0,0])),t.drawCircle(e*n.x,e*n.y,e*(a/2)),t.closePath(),t.endFill()})}}]),e}());e["default"]=d}),require.register("experimental/texture_generators/links.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=a(l),s=t("common/color"),c=a(s),f=t("d3"),d=(r(f),function(){function e(){i(this,e),this.points=[],this.size=10;var t=1.5*this.size|0;this.angle=Math.PI/t,console.log("Links size: "+this.size+", angle divider: "+t)}return o(e,[{key:"random_point",value:function(){return{x:2*Math.random()-1,y:2*Math.random()-1}}},{key:"generate",value:function(){for(var e=[],t=[],n=0;n<2*Math.PI;n+=this.angle){var r=u["default"].from_polar_coords(n,1);r.on_border=!0,this.points.push(r),e.push(r)}for(var a=this.calc_step(),i=-1;i<1;i+=a)for(var o=-1;o<1;o+=a){var l={x:o,y:i,on_border:!1};this.check_in_circle(l,1-a/2)&&(this.points.push(l),t.push(l))}var s=t.concat(e);t.forEach(function(e){return e.links=s.filter(function(t){return u["default"].distance(e,t)<=1.5*a})});var c=t.slice();this.process_links(c)}},{key:"process_links",value:function(e){if(e.length){var t=u["default"].rand_element(e);if(t.links.length<2)throw"bad element, less than 2 links";var n=t.links.filter(function(e){return e.on_border}).length,r=n>1?t.links:t.links.filter(function(e){return!e.on_border}),a=u["default"].rand_element(r);u["default"].remove_element(a,t.links),t.links.length<=2&&u["default"].remove_element(t,e),a.on_border||(u["default"].remove_element(t,a.links)||console.log("WARNING! linked element had no backlink",a,t),a.links.length<2&&!a.on_border&&console.log("too bad but some point now has less that 2 links",a),a.links.length<=2&&u["default"].remove_element(a,e)),this.process_links(e)}}},{key:"check_in_circle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return u["default"].distance(e,{x:0,y:0})<t}},{key:"calc_step",value:function(){return 2/this.size}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.draw_naive.bind(this),n=new PIXI.Graphics;return t(n,e),n}},{key:"draw_naive",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.calc_step(),r=n/6,a=[30,0,0];this.points.forEach(function(i){e.beginFill(c["default"].to_pixi(a)),e.drawCircle(t*i.x,t*i.y,t*r),e.closePath(),e.endFill(),i.links&&i.links.forEach(function(r){e.lineStyle(t*n/10,c["default"].to_pixi(a)),e.moveTo(t*i.x,t*i.y),e.lineTo(t*r.x,t*r.y),e.closePath(),e.lineStyle(0,c["default"].to_pixi(a))})})}}]),e}());e["default"]=d}),require.register("experimental/texture_generators/points_in_circle.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=a(l),s=t("common/color"),c=a(s),f=t("d3"),d=r(f),h=function(){function e(){i(this,e)}return o(e,[{key:"generate",value:function(e,t){for(this.points=[];e--;){var n=2*Math.random()*Math.PI,r=t(Math.random()),a=u["default"].from_polar_coords(n,r);this.points.push({angle:n,radius:r,x:a.x,y:a.y})}return this.points,!0}},{key:"draw",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[50,100,0],n=new PIXI.Graphics,r=.01;return this.points.forEach(function(a){n.beginFill(c["default"].to_pixi(c["default"].random_near(t,20))),n.drawCircle(e*a.x,e*a.y,e*r),n.closePath(),n.endFill()}),n}},{key:"draw_triangles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[50,100,0],n=d.voronoi().x(function(e){return e.x}).y(function(e){return e.y}),r=n(this.points),a=r.triangles(),i=new PIXI.Graphics;return a.forEach(function(n){i.beginFill(c["default"].to_pixi(c["default"].random_near(t,20))),i.drawPolygon(n.map(function(t){return new PIXI.Point(e*t.x,e*t.y)})),i.closePath(),i.endFill()}),i.lineStyle(.005*e,c["default"].to_pixi(c["default"].brighter(t,100))),a.forEach(function(t){i.moveTo(e*t[0].x,e*t[0].y),i.lineTo(e*t[1].x,e*t[1].y),i.moveTo(e*t[1].x,e*t[1].y),i.lineTo(e*t[2].x,e*t[2].y),i.moveTo(e*t[2].x,e*t[2].y),i.lineTo(e*t[0].x,e*t[0].y)}),i}}],[{key:"linear",value:function(e){return e}},{key:"pow",value:function(e){return Math.pow(e,.2)}}]),e}();e["default"]=h}),require.register("experimental/vichniac_vote.js",function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=t("experimental/tableau_drawer"),i=function(){return 1},o=function(e){return r({},e,{color:Math.random()>.5?1:0})},l=function(e,t){var n=e.x,o=e.y,l=(0,a.getElementColor)(n-1,o-1,t,i),u=(0,a.getElementColor)(n+0,o-1,t,i),s=(0,a.getElementColor)(n+1,o-1,t,i),c=(0,a.getElementColor)(n-1,o+0,t,i),f=(0,a.getElementColor)(n+0,o+0,t,i),d=(0,a.getElementColor)(n+1,o+0,t,i),h=(0,a.getElementColor)(n-1,o+1,t,i),_=(0,a.getElementColor)(n+0,o+1,t,i),p=(0,a.getElementColor)(n+1,o+1,t,i);return r({},e,{new_color:l+u+s+c+f+d+h+_+p>4?1:0})};(0,a.createTableauDrawer)(o,l,15,20,200,200)}),require.register("geo/balls_generator.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=t("common/voronoi_diagram"),s=r(u),c=t("common/color"),f=r(c),d=function(){function e(t,n,r){a(this,e),this.diagram=t,this.color_map=n,this.drawer=r}return i(e,[{key:"generate",value:function(){var e=.6*this.drawer.map.view.width*this.drawer.map.view.height|0;console.log("num_balls",e);for(var t=1,n=5,r=5,a=2,i=new PIXI.Graphics;e--;){var o=l["default"].rand(1,this.drawer.map.view.width-1),u=l["default"].rand(1,this.drawer.map.view.height-1),c=s["default"].find({x:o,y:u},this.diagram),d=this.color_map[c.geo_type],h=f["default"].random_near(d,r,a),_=l["default"].rand(t,n);i.beginFill(f["default"].to_pixi(h)),i.drawCircle(o,u,_),i.endFill()}var p=i.generateCanvasTexture(PIXI.SCALE_MODES.LINEAR),m=new PIXI.Sprite(p);this.drawer.layers.geo.addChild(m)}}]),e}();e["default"]=d}),require.register("geo/components/app.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=t("common/components/collapsible_panel"),f=r(c),d=t("geo/components/debug_info"),h=r(d),_=t("geo/components/generate_world_form"),p=r(_),m=t("geo/components/drawing_settings_form"),y=r(m),v=t("geo/components/roads_form"),g=r(v),b=t("geo/components/legend"),w=r(b),k=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return s["default"].createElement("table",{style:{margin:"5px",borderSpacing:"5px",borderCollapse:"separate"}},s["default"].createElement("tbody",null,s["default"].createElement("tr",{style:{verticalAlign:"top"}},s["default"].createElement("td",null,s["default"].createElement("div",{className:"panel-group"},s["default"].createElement("div",{className:"panel panel-success"},s["default"].createElement("div",{className:"panel-body"},s["default"].createElement("div",{className:"",id:"map_container"},s["default"].createElement("canvas",{id:"map",width:"800",height:"800"})))),s["default"].createElement(f["default"],{header:"debug",name:"debug",content_func:function(){return s["default"].createElement(h["default"])}}))),s["default"].createElement("td",{width:"100%"},s["default"].createElement("div",{className:"panel-group"},s["default"].createElement("div",{className:"panel panel-success"},s["default"].createElement("div",{className:"panel-body"},s["default"].createElement(f["default"],{header:"world generating",name:"generate_world",content_func:function(){return s["default"].createElement(p["default"])}}),s["default"].createElement(f["default"],{header:"drawing settings",name:"drawing_settings",content_func:function(){return s["default"].createElement(y["default"])}}),s["default"].createElement(f["default"],{header:"roads",name:"roads",content_func:function(){return s["default"].createElement(g["default"])}})),s["default"].createElement("div",{className:"panel-footer"},s["default"].createElement(f["default"],{header:"legend",name:"legend",content_func:function(){return s["default"].createElement(w["default"])}}))))))))}}]),t}(s["default"].Component);e["default"]=k}),require.register("geo/components/debug_info.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return s["default"].createElement("div",null,s["default"].createElement("div",null,"FPS:",s["default"].createElement("span",{id:"fps_counter"})),s["default"].createElement("div",null,"map scale:",s["default"].createElement("span",{id:"map_scale"})),s["default"].createElement("div",null,"mouse position:",s["default"].createElement("span",{id:"mouse_pos"},0)),s["default"].createElement("div",null,"world point:",s["default"].createElement("span",{id:"world_pos"},0)))}}]),t}(s["default"].Component);e["default"]=c}),require.register("geo/components/drawing_settings_form.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=t("common/components/input_spinner"),f=(r(c),t("common/components/active_checkbox")),d=r(f),h=t("geo/game"),_=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),l(t,[{key:"submit",value:function(e){e.preventDefault()}}]),l(t,[{key:"checkbox_handler",value:function(e,t){h.game.map_drawer.draw_voronoi_diagram=!h.game.map_drawer.draw_voronoi_diagram,h.game.map_drawer.set_layers_visibility(),this.setState({})}},{key:"create_checkbox",value:function(e,t){return s["default"].createElement(d["default"],{checked:h.game.map_drawer[e],handler:function(){return h.game.map_drawer[e]=!h.game.map_drawer[e],h.game.map_drawer.set_layers_visibility(),h.game.map_drawer[e]},text:t})}},{key:"render",value:function(){return s["default"].createElement("div",null,s["default"].createElement("form",{className:"form-horizontal"},this.create_checkbox("draw_voronoi_diagram","draw voronoi diagram")))}}]),t}(s["default"].Component);e["default"]=_}),require.register("geo/components/generate_world_form.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=t("common/components/input_spinner"),f=r(c),d=t("geo/game"),h=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"submit",value:function(e){d.game.rrt_epsilon=parseInt(document.querySelector("#gwf_rrt_epsilon").value),e.preventDefault(),console.clear(),d.game.map_drawer.map.stage.children.forEach(function(e){return e.removeChildren()}),d.game.generate_map()}},{key:"render",value:function(){return s["default"].createElement("div",null,s["default"].createElement("form",{className:"form-horizontal"},s["default"].createElement("div",{className:"form-group"},s["default"].createElement("label",{htmlFor:"epsilon",className:"col-sm-4 control-label"},"rrt nodes distance"),s["default"].createElement("div",{className:"col-sm-8"},s["default"].createElement(f["default"],{name:"gwf_rrt_epsilon",value:d.game.rrt_epsilon}))),s["default"].createElement("div",{className:"form-group"},s["default"].createElement("div",{className:"col-sm-offset-4 col-sm-8"},s["default"].createElement("button",{type:"button",className:"btn btn-default",id:"generate_world",onClick:this.submit.bind(this)},"generate")))))}}]),t}(s["default"].Component);e["default"]=h}),require.register("geo/components/legend.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return s["default"].createElement("div",null,s["default"].createElement("p",null,"here will be map legend..."))}}]),t}(s["default"].Component);e["default"]=c}),require.register("geo/components/roads_form.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return s["default"].createElement("div",null,s["default"].createElement("form",{className:"form-horizontal"},s["default"].createElement("p",null,"in test mode for now, nothing works..."),s["default"].createElement("button",{type:"button",className:"btn btn-success",id:"build_road"},"build road"),s["default"].createElement("div",{id:"road_text"})))}}]),t}(s["default"].Component);e["default"]=c}),require.register("geo/game.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=t("common/voronoi_diagram"),s=r(u),c=t("geo/regions_gatherer"),f=(r(c),t("geo/rrt_diagram")),d=r(f),h=t("geo/geo"),_=r(h),p=t("common/a_star"),m=(r(p),t("geo/interaction")),y=r(m),v=t("geo/map_drawer"),g=r(v),b=t("geo/components/app"),w=r(b),k=t("react-dom"),x=r(k),E=t("react"),j=r(E),O=function(){function e(){a(this,e),this.width=800,this.height=800,this.cells_count=1/0,this.rrt_epsilon=35,this.rrt_reject_limit=500,this.map_drawer=new g["default"],this.interaction=new y["default"]}return i(e,[{key:"generate_map",value:function(){var e=this;this.rrt=new d["default"](this.width,this.height),this.rrt.generate(this.rrt_epsilon,this.cells_count,this.rrt_reject_limit),this.diagram=s["default"].generate(this.rrt.nodes,this.width,this.height),this.diagram.cells.forEach(function(e){return e.closest_backlinks=[]}),this.diagram.cells.forEach(function(e){e.closest_link=e.links[0],l["default"].push_uniq(e,e.closest_link.closest_backlinks)}),this.diagram.cells.forEach(function(e){e.on_border=!1}),this.diagram.edges.forEach(function(t){t.right||(t.on_border=!0,t.from.on_border=!0,t.to.on_border=!0,e.diagram.cells[t.left.index].on_border=!0)}),this.map_drawer.init(this.diagram,this.rrt,this.width,this.height),this.interaction.init(),this.geo=new _["default"](this.diagram,this.rrt,this.map_drawer),this.map_drawer.draw(),this.map_drawer.highlight_bad_river_links(),this.map_drawer.highlight_local_minimums()}}]),e}(),M=new O;n.exports.game=M,document.addEventListener("DOMContentLoaded",function(){x["default"].render(j["default"].createElement(w["default"],null),document.querySelector("#app")),M.generate_map()})}),require.register("geo/geo.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=t("geo/rrt_diagram"),s=(r(u),t("geo/rivers_and_lakes_generator")),c=r(s),f=function(){function e(t,n,r){a(this,e),this.map_drawer=r,this.sea_ratio=.3,this.rock_height_ratio=.75,this.rrt_regions=3,this.diagram=t,this.rrt=n;var i=l["default"].find_min_and_max(this.rrt.nodes,function(e){return e.branch_order}).max;console.log("WE GONNA remove_some_links_and_recalc_all",this.rrt_regions-1);var o=this.rrt.remove_some_links_and_recalc_all(this.rrt_regions-1,i-10,i-2),u=this.rrt.nodes.filter(function(e){return 0==e.generation});console.log("rrt centers",u),this.init_height(),this.generate_heights_by_rrt_generations(),this.generate_heights_by_rrt_branches_length(),this.height_smooth(),this.set_nodes_height_by_cell_height(),this.generate_sea(this.sea_ratio),this.rrt.restore_removed_links(o),this.map_drawer.highlight_deleted_links(o),this.generate_rivers(),this.generate_rocks_by_height(),this.calc_fertility(),this.geo_types_by_fertility()}return i(e,[{key:"generate_sea",value:function(e){var t=this,n=Math.floor(e*this.diagram.cells.length),r=0,a=function(e){if(r>=n)return"break";var a=[];t.diagram.cells.forEach(function(t){t.height<=e&&"sea"!=t.geo_type&&a.push(t)});var i=void 0;do i=a.length,a=a.filter(function(e){return!e.on_border&&!e.links.some(function(e){return"sea"==e.geo_type})||(e.geo_type="sea",r++,!1)});while(a.length&&i!=a.length)};for(var i in this.heights_stat()){var o=a(i);if("break"===o)break}this.diagram.cells.forEach(function(e){e.shore="sea"!=e.geo_type&&e.links.some(function(e){return"sea"==e.geo_type})})}},{key:"generate_rocks_by_height",value:function(){var e=this,t=l["default"].find_min_and_max(this.rrt.nodes,function(e){return e.height}).max;this.rock_from_height=Math.ceil(this.rock_height_ratio*t),this.diagram.cells.forEach(function(t){t.height>=e.rock_from_height&&(t.geo_type="rock")})}},{key:"generate_rivers",value:function(){c["default"].generate_by_edges(this.diagram);
}},{key:"calc_fertility",value:function(){var e=0;this.diagram.cells.forEach(function(t){return e+=l["default"].convex_polygon_square(t.nodes)});var t=Math.round(e/this.diagram.cells.length);this.diagram.cells.forEach(function(e){if("sea"==e.geo_type)return void(e.fertility=0);var n=0,r=l["default"].convex_polygon_square(e.nodes);e.nodes.forEach(function(e){return n+=e.river?e.river.strength:0}),e.fertility=Math.ceil(t*n/r)})}},{key:"geo_types_by_fertility",value:function(){var e=[];this.diagram.cells.forEach(function(t){return l["default"].push_uniq(t.fertility,e)}),e.sort(function(e,t){return e-t});var t=e[0],n=e[Math.floor(.95*e.length)],r={bog:l["default"].normalize_value(.55,1,n,0,t),grass:l["default"].normalize_value(.15,1,n,0,t),steppe:l["default"].normalize_value(.05,1,n,0,t),desert:l["default"].normalize_value(0,1,n,0,t)};this.diagram.cells.forEach(function(e){if(!e.geo_type)for(var t in r)if(e.fertility>=r[t]){e.geo_type=t;break}})}},{key:"init_height",value:function(){this.rrt.nodes.forEach(function(e){return e.height=0})}},{key:"generate_heights_by_rrt_branches_length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.rrt.nodes.forEach(function(n){return n.height+=e*n.branch_order+t})}},{key:"height_smooth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.3,t=l["default"].find_min_and_max(this.rrt.nodes,function(e){return e.height}),n=e*(t.max-t.min),r=0;do r=0,this.diagram.cells.forEach(function(e){var t=l["default"].find_min_and_max(e.links,function(e){return e.height}).max,a=t-n;e.height<a&&(e.height=a,r++)}),console.log("height smooth cycle cells changed",r);while(r>0)}},{key:"generate_heights_by_rrt_generations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=l["default"].rand(t,e);this.rrt.nodes.forEach(function(e){return e.height+=Math.max(e.height,r-n*e.generation)})}},{key:"set_nodes_height_by_cell_height",value:function(){this.diagram.nodes.forEach(function(e){e.height=l["default"].find_min_and_max(e.cells,function(e){return e.height}).min})}},{key:"heights_stat",value:function(){var e=[];return this.diagram.cells.forEach(function(t){e[t.height]||(e[t.height]=0),e[t.height]++}),e}}]),e}();e["default"]=f}),require.register("geo/interaction.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=(a(l),t("common/voronoi_diagram")),s=a(u),c=t("d3"),f=r(c),d=t("geo/game"),h=function(){function e(){i(this,e),this.cell_under_cursor=null,this.state="initial"}return o(e,[{key:"init",value:function(){var e=this;this.game=d.game,document.getElementById("build_road").onclick=this.build_road_button_handler.bind(this),this.map=this.game.map_drawer.map,this.map.stage.interactive=!0,document.addEventListener("mousemove",this.map_mouse_move_handler.bind(this),!1),f.select("#map").on("click",this.map_click_handler.bind(this)),f.select("#map").call(f.zoom().scaleExtent([1,4]).translateExtent([[0,0],[this.map.view.width,this.map.view.height]]).on("zoom",this.map_zoom.bind(this))),this.road_text_div=document.getElementById("road_text"),this.ticks=0,this.fps_div=document.getElementById("fps_counter"),this.map.ticker.add(function(){e.ticks++,e.ticks%10==0&&f.select("#fps_counter").html(0|e.map.ticker.FPS)}),this.update_map_scale()}},{key:"change_state",value:function(e){this.state=e,"initial"==e?(f.select("#road_text").html(""),this.road_start_cell=null):"build_road_choose_start"==e?(f.select("#road_text").html("click road start cell"),this.road_start_cell=null):"build_road_choose_finish"==e?f.select("#road_text").html("click road finish cell"):"build_road"==e&&(console.log("suppose the road is built now"),this.change_state("initial"))}},{key:"build_road_button_handler",value:function(e){this.change_state("build_road_choose_start")}},{key:"map_mouse_move_handler",value:function(e){if(e.target!=this.map.view)return this.game.map_drawer.clear_cell_under_cursor(),this.cell_under_cursor=null,!1;var t=this.get_mouse_coords(e),n=this.get_cell_under_cursor(t);this.cell_under_cursor&&this.cell_under_cursor==n||(this.game.map_drawer.highlight_cell_under_cursor(n),this.cell_under_cursor=n),f.select("#mouse_pos").html("{x: "+t.x+", y: "+t.y+"}");var r=this.mouse_coords_to_world_coords(t);f.select("#world_pos").html("{x: "+r.x+", y: "+r.y+"}")}},{key:"map_click_handler",value:function(){var e=this.get_mouse_coords(f.event),t=this.get_cell_under_cursor(e);return t?(console.log("mouse click cell under cursor",t),void("build_road_choose_start"==this.state?(this.road_start_cell=t,this.change_state("build_road_choose_finish")):"click road finish cell"==this.state&&(this.road_finish_cell=t,this.change_state("build_road")))):(console.log("dunno why, but no cell under cursor"),!1)}},{key:"map_zoom",value:function(){this.map.stage.position.x=f.event.transform.x,this.map.stage.position.y=f.event.transform.y,this.map.stage.scale.x=f.event.transform.k,this.map.stage.scale.y=f.event.transform.k,this.update_map_scale()}},{key:"update_map_scale",value:function(){f.select("#map_scale").html("{x: "+this.map.stage.scale.x+", y: "+this.map.stage.scale.y+"}")}},{key:"get_mouse_coords",value:function(e){return{x:e.offsetX,y:e.offsetY}}},{key:"get_cell_under_cursor",value:function(e){var t=this.mouse_coords_to_world_coords(e);return s["default"].find(t,this.game.map_drawer.diagram)}},{key:"mouse_coords_to_world_coords",value:function(e){var t=Math.floor((e.x-this.map.stage.position.x)/this.map.stage.scale.x),n=Math.floor((e.y-this.map.stage.position.y)/this.map.stage.scale.y);return{x:t,y:n}}}]),e}();e["default"]=h}),require.register("geo/map_drawer.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{!r&&l["return"]&&l["return"]()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=r(l),s=t("geo/rrt_diagram"),c=(r(s),t("geo/texture_generator")),f=(r(c),t("geo/balls_generator")),d=(r(f),t("common/color")),h=r(d),_=function(){function e(){a(this,e)}return o(e,[{key:"init",value:function(n,r,a,i){var o=this,l=t("pixi.js");this.map=new l.Application(a,i,{backgroundColor:h["default"].to_pixi([0,0,0]),antialias:!0,view:document.getElementById("map")}),console.log("renderer",this.map.renderer),this.layers={},e.layers().forEach(function(e){o.layers[e]=new l.Container,o.map.stage.addChild(o.layers[e])}),document.getElementById("map_container").appendChild(this.map.view),this.diagram=n,this.rrt=r}},{key:"draw",value:function(){this.draw_voronoi_diagram=!0,this.draw_rrt_links=!0,this.draw_arrows=!1,this.draw_height=!1,this.draw_rivers=!0,this.draw_geo_types=!0,this.dark_mode=!1;var t=[0,50,200];this.init_heignts(),this.init_geo_types(),this.init_arrows(),this.init_rrt(),this.init_rivers(t);var n=new PIXI.Graphics;this.layers.water.addChild(n),this.diagram.cells.forEach(function(r){"lake"==r.geo_type&&e.draw_smoothed_polygon(n,r.nodes,r,t)}),this.init_dark_mode(),this.set_layers_visibility()}},{key:"set_layers_visibility",value:function(){this.layers.heights.visible=this.draw_height,this.layers.geo.visible=this.draw_geo_types,this.layers.arrows.visible=this.draw_arrows,this.layers.rrt_links.visible=this.draw_rrt_links,this.layers.water.visible=this.draw_rivers,this.draw_voronoi_diagram||(this.layers.regions.visible=!1,this.layers.geo.visible=!1,this.layers.heights.visible=!1),this.layers.dim_cells.visible=this.dark_mode,this.layers.dim.visible=this.dark_mode}},{key:"clear_cell_under_cursor",value:function(){this.layers.under_cursor.removeChildren()}},{key:"highlight_cell_under_cursor",value:function(e){this.clear_cell_under_cursor();var t=e.nodes.map(function(e){return new PIXI.Point(e.x,e.y)}),n=new PIXI.Graphics;n.alpha=.75,n.lineStyle(3,h["default"].to_pixi([218,165,32])),n.drawPolygon(t),n.closePath();var r=new PIXI.Graphics;r.alpha=.35,r.beginFill(h["default"].to_pixi([255,255,255])),r.drawPolygon(t),r.closePath(),r.endFill(),this.layers.under_cursor.addChild(n),this.layers.under_cursor.addChild(r)}},{key:"init_rivers",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new PIXI.Graphics,a=new PIXI.Graphics;a.alpha=.5,this.diagram.nodes.forEach(function(n){if(n.river){if(0===n.river.strength){var i=[87,65,47];r.lineStyle(2,h["default"].to_pixi(i))}else r.lineStyle(e.get_line_width_for_river(n.river.strength),h["default"].to_pixi(t));n.river.children.forEach(function(t){r.moveTo(n.x,n.y),r.lineTo(t.x,t.y),r.closePath(),e.draw_arrow(n,t,a,1,[200,100,0])})}}),this.layers.water.addChild(r),n&&this.layers.water.addChild(a)}},{key:"highlight_bad_river_links",value:function(){var t=new PIXI.Graphics;t.alpha=.5,this.diagram.nodes.forEach(function(n){n.river&&n.river.children.forEach(function(r){r.height>n.height&&(console.log("river flows up",r.height,n.height),t.lineStyle(e.get_line_width_for_river(n.river.strength),h["default"].to_pixi([200,50,0])),t.moveTo(n.x,n.y),t.lineTo(r.x,r.y),t.closePath())})}),this.layers.water.addChild(t)}},{key:"highlight_local_minimums",value:function(){var t=this;this.diagram.cells.forEach(function(n){if("sea"!=n.geo_type&&n.links.every(function(e){return e.height>n.height})){var r=e.draw_polygon(n.nodes,[255,0,125]);r.alpha=.5,t.layers.errors.addChild(r),console.log("inland local minimum",n.x,n.y)}})}},{key:"print_text_for_each_cell",value:function(e){var t=this;this.diagram.cells.forEach(function(n){var r=e(n),a=new PIXI.Text(r,{fontFamily:"Arial",fontSize:10,fill:16715792});a.x=n.x+2,a.y=n.y,t.layers.errors.addChild(a)})}},{key:"highlight_deleted_links",value:function(e){var t=new PIXI.Graphics;e.forEach(function(e){var n=i(e,2),r=n[0],a=n[1];t.lineStyle(2,h["default"].to_pixi([250,125,0])),t.moveTo(r.x,r.y),t.lineTo(a.x,a.y),t.closePath()}),this.layers.errors.addChild(t)}},{key:"init_heignts",value:function(){var t=this,n=this.diagram.cells[0].height,r=this.diagram.cells[0].height;this.diagram.cells.forEach(function(e){e.height<n&&(n=e.height),e.height>r&&(r=e.height)}),this.diagram.cells.forEach(function(a){var i=u["default"].normalize_value(a.height,r,255,n,0),o=e.draw_polygon(a.nodes,[0,i,0]);t.layers.heights.addChild(o)})}},{key:"init_geo_types",value:function(){var t=this,n={sea:[0,50,100],rock:[60,60,50],lake:[0,150,0],bog:[50,100,0],grass:[0,150,0],steppe:[150,150,0],desert:[200,150,0]};this.diagram.cells.forEach(function(r){if(!n[r.geo_type])throw"no geo_type color for ".cell.geo_type;var a=n[r.geo_type],i=e.draw_polygon(r.nodes,a);t.layers.geo.addChild(i)})}},{key:"init_arrows",value:function(){var t=new PIXI.Graphics;this.layers.arrows.addChild(t),this.diagram.cells.forEach(function(n){return e.draw_arrow(n,n.closest_link,t,3,[50,50,0])})}},{key:"init_rrt",value:function(){var e=[0,125,255].sort(function(e,t){return.5-Math.random()}),t=new PIXI.Graphics;this.layers.rrt_links.addChild(t);var n=u["default"].find_min_and_max(this.rrt.nodes,function(e){return e.height});this.diagram.cells.forEach(function(r){t.lineStyle(0,h["default"].to_pixi([0,0,0]));var a=[u["default"].normalize_value(r.height,n.max,e[0],n.min,25),u["default"].normalize_value(r.height,n.max,e[1],n.min,25),u["default"].normalize_value(r.height,n.max,e[2],n.min,25)];t.beginFill(h["default"].to_pixi(a)),t.drawCircle(r.x,r.y,4),t.endFill(),r.rrt_links.forEach(function(e){t.lineStyle(3,h["default"].to_pixi(a)),t.moveTo(r.x,r.y),t.lineTo(e.x,e.y)})})}},{key:"init_dark_mode",value:function(){var t=this;this.diagram.cells.forEach(function(n){var r="sea"==n.geo_type||"lake"==n.geo_type?[0,0,100]:[0,0,0],a=e.draw_polygon(n.nodes,r);t.layers.dim_cells.addChild(a)});var n=new PIXI.Graphics;this.layers.dim.addChild(n),n.alpha=.75,n.beginFill=h["default"].to_pixi([0,0,0]),n.drawRect(0,0,this.map.view.width,this.map.view.height),n.endFill()}}],[{key:"layers",value:function(){return["regions","geo","heights","dim_cells","borders","water","rrt_links","arrows","edges","roads","errors","selection","under_cursor","dim"]}},{key:"get_line_width_for_river",value:function(e){return.5+Math.log(e)}},{key:"draw_polygon",value:function(e,t){var n=new PIXI.Graphics;return n.lineStyle(1,h["default"].to_pixi([0,30,0])),n.beginFill(h["default"].to_pixi(t)),n.drawPolygon(e.map(function(e){return new PIXI.Point(e.x,e.y)})),n.closePath(),n.endFill(),n}},{key:"draw_arrow",value:function(e,t,n,r,a){n.lineStyle(r,h["default"].to_pixi(a)),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.closePath();var i=u["default"].to_polar_coords(e.x-t.x,e.y-t.y).angle,o=u["default"].from_polar_coords(i-u["default"].radians(15),7*r),l=u["default"].from_polar_coords(i+u["default"].radians(15),7*r);n.beginFill(h["default"].to_pixi(a)),n.moveTo(o.x+t.x,o.y+t.y),n.lineTo(t.x,t.y),n.lineTo(l.x+t.x,l.y+t.y),n.closePath(),n.endFill()}},{key:"draw_smoothed_polygon",value:function(e,t,n,r){t=t.map(function(e){return u["default"].move_by_vector(e,n,u["default"].rand_float(.1,.3))});var a=t.reduce(function(e,t){return e+u["default"].distance(t,n)},0)/t.length;t=t.filter(function(e,n){var r=n+1==t.length?0:n+1,i=t[r];return u["default"].distance(e,i)>=.2*a}),e.beginFill(h["default"].to_pixi(r));var i={x:(t[0].x+u["default"].last(t).x)/2,y:(t[0].y+u["default"].last(t).y)/2};e.moveTo(i.x,i.y),u["default"].for_all_consecutive_pairs(t,function(t,n){var r={x:(n.x+t.x)/2,y:(n.y+t.y)/2};e.quadraticCurveTo(t.x,t.y,r.x,r.y)}),e.endFill()}},{key:"draw_broken_line_between_two_cells",value:function(t,n,r,a,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=e.two_cells_edge_midpoint(a,t,n);r.lineStyle(o,h["default"].to_pixi(i)),r.moveTo(t.x,t.y),r.lineTo(l.x,l.y),r.moveTo(l.x,l.y),r.lineTo(n.x,n.y)}},{key:"two_cells_edge_midpoint",value:function(e,t,n){var r=void 0;for(var a in n.halfedges){var i=e.edges[n.halfedges[a]];if(i.left==t||i.right==t){r=i;break}}if(!r)throw console.log("two_cells_edge_midpoint not linked cells",t,n),"two_cells_edge_midpoint not linked cells";return{x:(r.from.x+r.to.x)/2,y:(r.from.y+r.to.y)/2}}}]),e}();e["default"]=_}),require.register("geo/regions_gatherer.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=function(){function e(){a(this,e)}return i(e,null,[{key:"gather_regions",value:function(t){var n="rrt_leafs";if(t.regions=[],"rrt_leafs"==n){var r=t.cells.filter(function(e){return 2!=e.rrt_links.length});r.forEach(function(e){var n={color:MapDrawer.random_color(),cells:[e]};t.regions.push(n),e.region=n}),r.forEach(function(t){return e.gather_all_parents_to_my_region(t)}),e.recursively_merge_small_regions(t),t.regions.forEach(function(e,t){return e.index=t})}else{var a=void 0;if("closest"==n)a=function(e){return e.closest_backlinks.concat([e.closest_link])};else if("rrt"==n)a=function(e){return e.rrt_links};else{if("rrt_generations"!=n)throw"unknown regions_mode: "+n;var i=5;a=function(e){var t=Math.floor(e.generation/i);return e.rrt_links.filter(function(e){return Math.floor(e.generation/i)==t})}}t.cells.forEach(function(n){return e.diagram_collect_regions(t,n,a)})}t.regions.forEach(function(e){e.on_border=!1;for(var t=0;t<e.cells.length;t++)if(e.cells[t].on_border){e.on_border=!0;break}})}},{key:"diagram_collect_regions",value:function(e){function t(t,n,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,n){if(!t.region){for(var r=n(t),a=void 0,i=0;i<r.length;i++)if(r[i].region){a=r[i].region;break}a||(a={color:MapDrawer.random_color(),index:e.regions.length,cells:[]},e.regions.push(a)),t.region=a,a.cells.push(t),r.forEach(function(r){return diagram_collect_regions(e,t,n)})}})},{key:"gather_all_parents_to_my_region",value:function(t){var n=RRTDiagram.get_parent(t);if(n&&!n.region)return n.region=t.region,t.region.cells.push(n),e.gather_all_parents_to_my_region(n)}},{key:"rrt_leafs_move_all_cells_from_region_to_another_and_delete_it",value:function(e,t,n){e.cells.forEach(function(e){e.region=t,t.cells.push(e)}),e.cells.splice(0,e.cells.length),l["default"].remove_element(e,n.regions)}},{key:"recursively_merge_small_regions",value:function(t){var n=t.regions.filter(function(e){return e.cells.length<regions_min_cells});if(n.length){var r=e.sort_regions_by_size(n)[0],a=e.gather_all_linked_regions(r);e.sort_regions_by_size(a);var i=a[0];e.rrt_leafs_move_all_cells_from_region_to_another_and_delete_it(r,i,t),e.recursively_merge_small_regions(t)}}},{key:"gather_all_linked_regions",value:function(e){var t=[];return e.cells.forEach(function(n){n.rrt_links.forEach(function(n){n.region&&n.region!=e&&l["default"].push_uniq(n.region,t)})}),t}},{key:"sort_regions_by_size",value:function(e){return e.sort(function(e,t){return e.cells.length-t.cells.length})}}]),e}();e["default"]=u}),require.register("geo/rivers_and_lakes_generator.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=t("geo/rrt_diagram"),s=r(u),c=t("geo/map_drawer"),f=(r(c),function(){function e(){a(this,e)}return i(e,null,[{key:"generate_by_edges",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=t.edges.filter(function(e){if(!e.right)return!1;var t=s["default"].check_linked(e.right,e.left),n="sea"==e.right.geo_type||"sea"==e.left.geo_type;return!t&&!n}),a=[],i=[],o=[];return r.forEach(function(e){l["default"].for_all_consecutive_pairs([e.from,e.to],function(e,t){l["default"].push_uniq(e,a),e.river_links||(e.river_links=[]),l["default"].push_uniq(t,e.river_links)})}),a.forEach(function(e){e.river={strength:0,parents:[],children:[]},e.on_border?o.push(e):e.cells.some(function(e){return"sea"==e.geo_type})?o.push(e):1==e.river_links.length&&(e.river.strength=Math.random()>n?l["default"].rand(1,10):0,i.push(e))}),o.forEach(function(t){e.recursively_walk_from_ends(t,null)}),i.forEach(function(t){return e.recursively_add_strength(t,t.river.strength)}),a.forEach(function(e){return delete e.river_links}),!0}},{key:"recursively_walk_from_ends",value:function(t,n){n&&(l["default"].remove_element(t,n.river.children),n.river.parents.push(t),l["default"].remove_element(n,t.river.parents),t.river.children.push(n));var r=t.river_links.filter(function(e){return e!=n});r.length>1&&r.every(function(e){return e.river.children.length})||r.forEach(function(n){e.recursively_walk_from_ends(n,t)})}},{key:"recursively_add_strength",value:function(t,n){t.river.children.forEach(function(t){t.river.strength+=n,e.recursively_add_strength(t,n)})}}]),e}());e["default"]=f}),require.register("geo/rrt_diagram.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{!r&&l["return"]&&l["return"]()}finally{if(a)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=r(l),s=function f(e,t){a(this,f),this.x=e,this.y=t,this.rrt_links=[],this.generation=null,this.branch_order=null},c=function(){function e(t,n){a(this,e),this.nodes=[],this.x_size=t,this.y_size=n}return o(e,[{key:"get_generation",value:function(e){return this.nodes.filter(function(t){return t.generation==e})}},{key:"generations_count",value:function(){return u["default"].find_min_and_max(this.nodes,function(e){return e.generation}).max}},{key:"generate",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;if(this.epsilon=t,this.nodes.push(new s(u["default"].rand(1,this.x_size-1),u["default"].rand(1,this.y_size-1))),n<0)throw"bad number of nodes given: "+n;for(var a=0;n&&a<r;){var i={x:u["default"].rand(1,this.x_size-1),y:u["default"].rand(1,this.y_size-1)},o=e.find_nearest_node(i,this.nodes),l=e.distance(i,o);if(l<t*t||0===l)a++;else{var c=Math.atan2(i.y-o.y,i.x-o.x),f=new s(Math.round(o.x+t*Math.cos(c)),Math.round(o.y+t*Math.sin(c)));this.nodes.push(f),e.link_two_nodes(f,o),a=0,n--}}this.calc_branches_length_and_generations()}},{key:"remove_some_links_and_recalc_all",value:function(t,n,r){var a=this.nodes.filter(function(e){return e.branch_order>=n&&e.branch_order<=r});if(a.length<t)throw"cant remove_some_links_and_recalc_all() count "+t+" cause only "+a.length+" sutable nodes";a.sort(function(){return.5-Math.random()});for(var i=[],o=0;o<t;o++){var l=a[o],u=l.rrt_links.find(function(e){return e.branch_order>=n-1&&e.branch_order<=r+1});if(!u)throw"strange, not found sutable link";e.delink_two_nodes(l,u),i.push([l,u])}return this.calc_branches_length_and_generations(),i}},{key:"restore_removed_links",value:function(t){t.forEach(function(t){var n=i(t,2),r=n[0],a=n[1];return e.link_two_nodes(r,a)}),this.calc_branches_length_and_generations()}},{key:"calc_branches_length_and_generations",value:function(){var e=this;this.nodes.forEach(function(e){e.generation=null,e.branch_order=null,e.longest_branch=null}),this.nodes.forEach(function(t){t.branch_length=0,e.recursively_set_branch_length(t),t.longest_branch=u["default"].find_min_and_max(e.nodes,function(e){return e.branch_length}).max,e.nodes.forEach(function(e){return delete e.branch_length})});var t=[];this.nodes.forEach(function(e){var n=e.rrt_links.every(function(t){return t.longest_branch>=e.longest_branch}),r=e.rrt_links.every(function(e){return t.indexOf(e)==-1});n&&r&&t.push(e)}),this.nodes.forEach(function(e){return e.generation=null}),t.forEach(function(t){t.generation=0,e.recursively_set_generation(t)});var n=this.nodes.filter(function(e){return 1==e.rrt_links.length});n.forEach(function(t){t.branch_order=0,e.recursively_calc_branch_order(t)})}},{key:"recursively_set_generation",value:function(e){var t=this,n=e.rrt_links.filter(function(e){return null==e.generation});n.forEach(function(t){return t.generation=e.generation+1}),n.forEach(function(e){return t.recursively_set_generation(e)})}},{key:"recursively_set_branch_length",value:function(e){var t=this,n=e.rrt_links.filter(function(e){return null==e.branch_length});n.forEach(function(t){return t.branch_length=e.branch_length+1}),n.forEach(function(e){return t.recursively_set_branch_length(e)})}},{key:"recursively_calc_branch_order",value:function(e){var t=this,n=e.rrt_links.filter(function(t){var n=t.generation<e.generation,r=null==t.branch_order||t.branch_order<e.branch_order+1;return n&&r});if(n.length>1)throw"seens like several parents";n.forEach(function(t){return t.branch_order=e.branch_order+1}),n.forEach(function(e){return t.recursively_calc_branch_order(e)})}}],[{key:"check_linked",value:function(e,t){return e.rrt_links.indexOf(t)!=-1}},{key:"find_nearest_node",value:function(t,n){if(!n[0])throw"no nodes";var r=n[0],a=e.distance(t,r);for(var i in n){var o=e.distance(n[i],t);o<a&&(r=n[i],a=o)}return r}},{key:"link_two_nodes",value:function(e,t){u["default"].push_uniq(e,t.rrt_links),u["default"].push_uniq(t,e.rrt_links)}},{key:"delink_two_nodes",value:function(e,t){u["default"].remove_element(e,t.rrt_links),u["default"].remove_element(t,e.rrt_links)}},{key:"get_parent",value:function(e){var t=e.rrt_links.filter(function(t){return t.generation<e.generation});if(!t.length)return null;if(1!=t.length)throw console.log("more than one parent",e),"more than one parent";return t[0]}},{key:"distance",value:function(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}}]),e}();e["default"]=c}),require.register("geo/texture_generator.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=(r(o),t("common/color")),u=r(l),s=function(){function e(){a(this,e)}return i(e,[{key:"simple",value:function(e){return this.generate(e,400,2)}},{key:"generate",value:function(e,t,n){for(var r=new PIXI.Graphics,a=0;a<t;a++)for(var i=0;i<t;i++)r.beginFill(u["default"].to_pixi(u["default"].random_near(e))),r.drawRect(n*i,n*a,n,n),r.endFill();var o=r.generateCanvasTexture(PIXI.SCALE_MODES.NEAREST,1);return o}}]),e}();e["default"]=s}),require.register("planets/components/app.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("common/components/collapsible_panel"),s=r(u),c=t("planets/components/debug_info"),f=r(c),d=t("planets/components/generate_world_form"),h=r(d),_=t("react"),p=r(_),m=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return p["default"].createElement("table",{style:{margin:"5px",borderSpacing:"5px",borderCollapse:"separate"}},p["default"].createElement("tbody",null,p["default"].createElement("tr",{style:{verticalAlign:"top"}},p["default"].createElement("td",null,p["default"].createElement("div",{className:"panel-group"},p["default"].createElement("div",{className:"panel panel-success"},p["default"].createElement("div",{className:"panel-body"},p["default"].createElement("div",{className:"",id:"map_container"},p["default"].createElement("canvas",{id:"map",width:"800",height:"800"})))),p["default"].createElement(s["default"],{header:"debug",name:"debug",content_func:function(){return p["default"].createElement(f["default"])}}))),p["default"].createElement("td",{width:"100%"},p["default"].createElement("div",{className:"panel-group"},p["default"].createElement("div",{className:"panel panel-success"},p["default"].createElement("div",{className:"panel-body"},p["default"].createElement(s["default"],{header:"world generating",name:"generate_world",content_func:function(){return p["default"].createElement(h["default"])}})),p["default"].createElement("div",{className:"panel-footer"})))))))}}]),t}(p["default"].Component);e["default"]=m}),require.register("planets/components/debug_info.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"render",value:function(){return s["default"].createElement("div",null,s["default"].createElement("div",null,"FPS:",s["default"].createElement("span",{id:"fps_counter"})),s["default"].createElement("div",null,"map scale:",s["default"].createElement("span",{id:"map_scale"})),s["default"].createElement("div",null,"mouse position:",s["default"].createElement("span",{id:"mouse_pos"},0)),s["default"].createElement("div",null,"world point:",s["default"].createElement("span",{id:"world_pos"},0)))}}]),t}(s["default"].Component);e["default"]=c}),require.register("planets/components/generate_world_form.jsx",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t);
}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=t("react"),s=r(u),c=t("common/components/input_spinner"),f=(r(c),t("planets/game")),d=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),l(t,[{key:"submit",value:function(e){e.preventDefault(),console.clear(),f.game.map_drawer.map.stage.children.forEach(function(e){return e.removeChildren()}),f.game.generate_world()}},{key:"render",value:function(){return s["default"].createElement("div",null,s["default"].createElement("form",{className:"form-horizontal"},s["default"].createElement("div",{className:"form-group"},s["default"].createElement("div",{className:"col-sm-offset-4 col-sm-8"},s["default"].createElement("button",{type:"button",className:"btn btn-default",id:"generate_world",onClick:this.submit.bind(this)},"generate")))))}}]),t}(s["default"].Component);e["default"]=d}),require.register("planets/game.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=(r(o),t("planets/star_system")),u=r(l),s=t("planets/interaction"),c=r(s),f=t("planets/map_drawer"),d=r(f),h=t("planets/components/app"),_=r(h),p=t("react-dom"),m=r(p),y=t("react"),v=r(y),g=function(){function e(){a(this,e),this.width=800,this.height=800,this.map_drawer=new d["default"],this.interaction=new c["default"]}return i(e,[{key:"generate_world",value:function(){this.star_system=new u["default"],this.star_system.generate(),this.ticks=0,this.map_drawer.init(this.width,this.height),this.interaction.init(),this.map_drawer.map.ticker.add(this.handle_tick.bind(this)),this.map_drawer.init_graphics()}},{key:"handle_tick",value:function(){this.ticks++,this.star_system.tick(),this.map_drawer.redraw()}}]),e}(),b=new g;n.exports.game=b,document.addEventListener("DOMContentLoaded",function(){m["default"].render(v["default"].createElement(_["default"],null),document.querySelector("#app")),b.generate_world()})}),require.register("planets/interaction.js",function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=t("common/util"),u=(a(l),t("planets/game")),s=t("d3"),c=r(s),f=function(){function e(){i(this,e),this.state="initial"}return o(e,[{key:"init",value:function(){var e=this;this.game=u.game,this.map=this.game.map_drawer.map,this.map.stage.interactive=!0,document.addEventListener("mousemove",this.map_mouse_move_handler.bind(this),!1),c.select("#map").on("click",this.map_click_handler.bind(this)),c.select("#map").call(c.zoom().scaleExtent([1,4]).translateExtent([[0,0],[this.map.view.width,this.map.view.height]]).on("zoom",this.map_zoom.bind(this))),this.ticks=0,this.fps_div=document.getElementById("fps_counter"),this.map.ticker.add(function(){e.ticks++,e.ticks%10==0&&c.select("#fps_counter").html(0|e.map.ticker.FPS)}),this.update_map_scale()}},{key:"map_mouse_move_handler",value:function(e){if(e.target!=this.map.view)return!1;var t=this.get_mouse_coords(e);c.select("#mouse_pos").html("{x: "+t.x+", y: "+t.y+"}");var n=this.mouse_coords_to_world_coords(t);c.select("#world_pos").html("{x: "+n.x+", y: "+n.y+"}")}},{key:"map_click_handler",value:function(){this.get_mouse_coords(c.event)}},{key:"map_zoom",value:function(){this.map.stage.position.x=c.event.transform.x,this.map.stage.position.y=c.event.transform.y,this.map.stage.scale.x=c.event.transform.k,this.map.stage.scale.y=c.event.transform.k,this.update_map_scale()}},{key:"update_map_scale",value:function(){c.select("#map_scale").html("{x: "+this.map.stage.scale.x+", y: "+this.map.stage.scale.y+"}")}},{key:"get_mouse_coords",value:function(e){return{x:e.offsetX,y:e.offsetY}}},{key:"mouse_coords_to_world_coords",value:function(e){var t=Math.floor((e.x-this.map.stage.position.x)/this.map.stage.scale.x),n=Math.floor((e.y-this.map.stage.position.y)/this.map.stage.scale.y);return{x:t,y:n}}}]),e}();e["default"]=f}),require.register("planets/map_drawer.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=t("common/color"),s=r(u),c=t("planets/game"),f=function(){function e(){a(this,e)}return i(e,[{key:"init",value:function(n,r){var a=this,i=t("pixi.js");this.map=new i.Application(n,r,{backgroundColor:s["default"].to_pixi([0,0,0]),antialias:!0,view:document.getElementById("map")}),console.log("renderer",this.map.renderer),this.base_container=new i.Container,this.base_container.scale={x:6,y:6},this.map.stage.addChild(this.base_container),this.base_container.position.x=n/2|0,this.base_container.position.y=r/2|0,this.layers={},e.layers().forEach(function(e){a.layers[e]=new i.Container,a.base_container.addChild(a.layers[e])}),document.getElementById("map_container").appendChild(this.map.view),this.bodies_graphics=[]}},{key:"clear_all",value:function(){this.base_container.children.forEach(function(e){return e.removeChildren()})}},{key:"init_graphics",value:function(){var e=this;this.init_stellar_body(c.game.star_system.star),c.game.star_system.planets.forEach(function(t){return e.init_stellar_body(t)})}},{key:"redraw",value:function(){var e=this;this.bodies_graphics.forEach(function(t){return e.update_stellar_body(t)})}},{key:"init_stellar_body",value:function(e){var t=new PIXI.Graphics;t.backlink=e;var n=s["default"].to_pixi(s["default"].darker(e.color,30));t.lineStyle(e.radius/10,n),t.beginFill(s["default"].to_pixi(e.color)),t.drawCircle(0,0,e.radius),t.closePath(),t.endFill(),this.small_circle(t,0,1,e,n),this.small_circle(t,0,-1,e,n),this.small_circle(t,1,0,e,n),this.small_circle(t,-1,0,e,n),this.layers.bodies.addChild(t),this.bodies_graphics.push(t),this.update_stellar_body(t)}},{key:"update_stellar_body",value:function(e){var t=e.backlink,n=l["default"].from_polar_coords(t.orbital_angle,t.orbital_radius);e.position.x=n.x,e.position.y=n.y,e.rotation=t.angle}},{key:"small_circle",value:function(e,t,n,r,a){e.lineStyle(r.radius/10,s["default"].to_pixi([0,0,0])),e.beginFill(a),e.drawCircle(t*(r.radius/2),n*(r.radius/2),r.radius/3),e.endFill()}}],[{key:"layers",value:function(){return["bodies","errors","test"]}}]),e}();e["default"]=f}),require.register("planets/star_system.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=t("common/util"),l=r(o),u=(t("planets/game"),t("planets/stellar_body")),s=r(u),c=t("common/color"),f=r(c),d=function(){function e(){a(this,e),this.star=null,this.planets=[],this.orbital_speed_coef=.0025,this.rotation_speed_coef=.01}return i(e,[{key:"generate",value:function(){this.star=new s["default"],this.star.radius=8,this.star.rotation_speed=this.rotation_speed_coef*l["default"].rand(1,10),this.star.color=f["default"].random_near([250,50,50]);for(var e=5;e--;){var t=new s["default"];t.orbital_radius=10*(e+2),t.radius=l["default"].rand(1,5),t.orbital_speed=this.orbital_speed_coef*l["default"].rand(1,10),t.rotation_speed=this.rotation_speed_coef*l["default"].rand(1,10),t.color=f["default"].random([200,200,200]),this.planets.push(t)}}},{key:"tick",value:function(){var e=this;this.update_stellar_body(this.star),this.planets.forEach(function(t){return e.update_stellar_body(t)})}},{key:"update_stellar_body",value:function(e){e.orbital_angle+=e.orbital_speed,e.angle+=e.rotation_speed}}]),e}();e["default"]=d}),require.register("planets/stellar_body.js",function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=t("common/util"),o=(r(i),t("planets/game"),function l(){a(this,l),this.orbital_radius=0,this.radius=0,this.orbital_speed=0,this.rotation_speed=0,this.color=[0,0,0],this.orbital_angle=0,this.angle=0});e["default"]=o}),require.alias("node-browser-modules/node_modules/buffer/index.js","buffer"),require.alias("node-browser-modules/node_modules/events/events.js","events"),require.alias("node-browser-modules/node_modules/stream-http/index.js","http"),require.alias("node-browser-modules/node_modules/https-browserify/index.js","https"),require.alias("path-browserify/index.js","path"),require.alias("process/browser.js","process"),require.alias("punycode/punycode.js","punycode"),require.alias("querystring-es3/index.js","querystring"),require.alias("stream-browserify/index.js","stream"),require.alias("node-browser-modules/node_modules/util/util.js","sys"),require.alias("url/url.js","url"),e=require("process"),require.register("___globals___",function(e,t,n){})}(),require("___globals___");