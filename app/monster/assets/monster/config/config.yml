dialogs:
- id: barmen_root
  sequence:
  - <b>: hey
  - <r>: what?
  - <b>: you're bitch
  - id: r_answer
    choose:
    - <r>: what! fuck off!
      cond: show_once_per_dialog
      sequence:
      - <b>: okay! but try_again
      - goto: r_answer
    - <r>: i gonna kill you!
      cond: show_once_per_dialog
      sequence:
      - cond: some == 1
        sequence:
        - <b>: im not impressed...
        - goto: lets_continue_here
      - cond: some == 2
        sequence:
        - <b>: oh, i dont take it seriously
        - goto: lets_continue_here
      - cond: some == 3
        sequence:
        - <b>: by the way, my friend agree with me
        - <c>: yeah, i agree!
        - <b>: see?
        - goto: lets_continue_here
      - id: lets_continue_here
        sequence:
        - <r>: and i dont care and kill you anyway!
        - <b>: boooring...
        - goto: r_answer
    - <r>: quit this shit now...
      sequence:
      - <b>: bye then!
    # choose element is sequence, not a phrase
    # cond applied to sequence, not a phrase!
    # we can fugure it as a 'null' phrase with 'sequence' prop
    - cond: today_is == 'sunday'
      sequence:
      - cond: roll == 1
        sequence:
        - <r>: sunday secret answer
        - <b>: oh, now! i'm sucked
        - goto: r_answer
      - cond: roll == 0
        sequence:
        - <r>: omg again i'm a looser
        - <b>: yeah, you are! and let's try again
        - goto: r_answer

###########################
###########################
scenes:
  mage_room:
    name: mage_room
    mobiles: [mage]
    furniture: [mage_room_table, mage_room_shelf, mage_room_bed]
    links:
    - id_scene: mage_home_hall
    - id_scene: mage_home_vallo_room
    dialogs: []
    #{talkers: [mage], node: 'mage_root'}

  mage_home_hall:
    name: mage_home_hall
    mobiles: [tricky_bell]
    furniture: [mage_home_hall_door, mage_home_hall_cellar_door, mage_home_hall_shelf]
    links:
    - id_scene: mage_room
    - id_scene: mage_home_cellar
    - id_scene: mage_home_outdoor
      preconditions:
      - type: flag
        name: mage_home_entrance_door_unlocked
        value: true
    dialogs:
      - {talkers: [tricky_bell], node: tricky_bell_root}

  mage_home_cellar:
    name: mage_home_cellar
    mobiles: []
    furniture:
    - mage_home_cellar_blue_seaweeds
    - mage_home_cellar_mushrooms
    - mage_home_cellar_well
    - mage_home_cellar_kitchen
    - mage_home_cellar_bed
    - mage_home_cellar_chest
    links:
    - id_scene: mage_home_hall

  mage_home_vallo_room:
    name: mage_home_vallo_room
    mobiles: []
    furniture: [mage_home_vallo_room_books, mage_home_vallo_room_nest]
    links:
    - id_scene: mage_room
    - id_scene: mage_home_loft

  mage_home_loft:
    name: mage_home_loft
    mobiles: []
    furniture:
    - mage_home_loft_portal
    - mage_home_loft_book_shelf
    - mage_home_loft_bottles_rack
    - mage_home_loft_big_basket
    - mage_home_loft_trash_pile
    links:
    - id_scene: mage_home_vallo_room

###########################
###########################
mobiles:
  rathni:
    name: rathni
    race: daemon

  mage:
    name: mage
    race: beast

  tricky_bell:
    name: tricky bell
    race: item

###########################
###########################
furniture:
  mage_room_table:
    items:
    - {type: bottle, owner: mage}
    - {type: blank_scroll, owner: mage}

  mage_room_shelf:
    items:
      - {type: fearful_beasts_book, owner: mage}

  mage_room_bed:
    items: []

  mage_home_hall_door:
    items: []

  mage_home_hall_cellar_door:
    items: []

  mage_home_hall_shelf:
    items: []

  mage_home_cellar_blue_seaweeds:
    items: []

  mage_home_cellar_mushrooms:
    items: []

  mage_home_cellar_well:
    items: []

  mage_home_cellar_kitchen:
    items: []

  mage_home_cellar_bed:
    items: []

  mage_home_cellar_chest:
    items: []

  # ???
  mage_home_vallo_room_books:
    items: []

  mage_home_vallo_room_nest:
    items: []
  
  mage_home_loft_portal:
    items: []

  mage_home_loft_book_shelf:
    items: []

  mage_home_loft_bottles_rack:
    items: []

  mage_home_loft_big_basket:
    items: []

  mage_home_loft_trash_pile:
    items: []
